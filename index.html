<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global SDGs Challenge - ä¸–ç•Œã®èª²é¡Œè§£æ±ºè€…</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a2a6c, #2a5298);
            color: #333;
            overflow-x: hidden;
        }
        .game-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        .country-mission {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        .mission-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 25px;
        }
        .country-flag {
            font-size: 48px;
        }
        .mission-info h2 {
            color: #2c3e50;
            margin-bottom: 8px;
        }
        .mission-description {
            color: #7f8c8d;
            line-height: 1.6;
        }
        .phase-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 25px 0;
        }
        .phase {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .phase:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(116, 185, 255, 0.4);
        }
        .phase.active {
            background: linear-gradient(135deg, #00b894, #00a085);
        }
        .action-panel {
            background: rgba(116, 185, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
        }
        .action-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 15px;
        }
        .action-card {
            background: white;
            border: 2px solid #74b9ff;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .action-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(116, 185, 255, 0.3);
        }
        .action-card.selected {
            border-color: #00b894;
            background: rgba(0, 184, 148, 0.1);
        }
        .resources-panel {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        .resource {
            background: white;
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        .resource-value {
            font-size: 24px;
            font-weight: bold;
            color: #2c3e50;
            margin: 8px 0;
        }
        .real-data-popup {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid #fdcb6e;
        }
        .progress-container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }
        .progress-bar {
            height: 12px;
            background: #ecf0f1;
            border-radius: 6px;
            margin: 10px 0;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00b894, #fdcb6e);
            border-radius: 6px;
            transition: width 0.5s ease;
        }
        .control-button {
            background: linear-gradient(135deg, #00b894, #00a085);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            margin: 10px;
            transition: all 0.3s ease;
        }
        .control-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 184, 148, 0.4);
        }
        .control-button:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        .floating-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #00b894, #00a085);
            color: white;
            padding: 15px 25px;
            border-radius: 15px;
            z-index: 1000;
            animation: slideInRight 0.5s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .sdgs-badge {
            display: inline-block;
            background: #FFD700;
            color: #000;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: bold;
            margin: 2px;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <div class="header">
            <h1>ğŸŒ Global SDGs Challenge - ä¸–ç•Œã®èª²é¡Œè§£æ±ºè€…</h1>
            <p>ä¸–ç•Œå„å›½ã‚’å·¡ã‚Šã€å®Ÿéš›ã®SDGsèª²é¡Œã‚’è§£æ±ºã›ã‚ˆï¼</p>
        </div>

        <!-- ãƒ«ãƒ¯ãƒ³ãƒ€ãƒŸãƒƒã‚·ãƒ§ãƒ³ -->
        <div class="country-mission">
            <div class="mission-header">
                <div class="country-flag">ğŸ‡·ğŸ‡¼</div>
                <div class="mission-info">
                    <h2>ãƒ«ãƒ¯ãƒ³ãƒ€ãƒŸãƒƒã‚·ãƒ§ãƒ³ - ãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯ã”ã¿å•é¡Œã®è§£æ±º</h2>
                    <div class="mission-description">
                        ã‚¢ãƒ•ãƒªã‚«ã®å°å›½ãƒ«ãƒ¯ãƒ³ãƒ€ã¯ã€ä¸–ç•Œã§æœ€ã‚‚å³ã—ã„ãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯ç¦æ­¢æ”¿ç­–ã§ã€Œã‚¢ãƒ•ãƒªã‚«ã®ã‚·ãƒ³ã‚¬ãƒãƒ¼ãƒ«ã€ã¨å‘¼ã°ã‚Œã‚‹ç¾ã—ã„å›½ã«ç”Ÿã¾ã‚Œå¤‰ã‚ã‚Šã¾ã—ãŸã€‚
                    </div>
                </div>
            </div>

            <!-- é€²è¡Œãƒ•ã‚§ãƒ¼ã‚º -->
            <div class="phase-container">
                <div class="phase active" id="phase1">1. èª²é¡Œåˆ†æ</div>
                <div class="phase" id="phase2">2. å¯¾ç­–è¨ˆç”»</div>
                <div class="phase" id="phase3">3. å®Ÿè¡Œ</div>
                <div class="phase" id="phase4">4. çµæœè©•ä¾¡</div>
            </div>

            <!-- ãƒªã‚½ãƒ¼ã‚¹è¡¨ç¤º -->
            <div class="resources-panel">
                <div class="resource">
                    <div>ğŸ’° äºˆç®—</div>
                    <div class="resource-value" id="budget">1,000,000</div>
                    <div>RWãƒ•ãƒ©ãƒ³</div>
                </div>
                <div class="resource">
                    <div>ğŸ‘¥ å¸‚æ°‘æ”¯æŒ</div>
                    <div class="resource-value" id="support">45%</div>
                    <div>æ”¯æŒç‡</div>
                </div>
                <div class="resource">
                    <div>ğŸ›ï¸ æ”¿æ²»çš„æ”¯æ´</div>
                    <div class="resource-value" id="political">60%</div>
                    <div>è­°ä¼šæ”¯æŒ</div>
                </div>
                <div class="resource">
                    <div>ğŸŒ¿ ç’°å¢ƒæŒ‡æ¨™</div>
                    <div class="resource-value" id="environment">30%</div>
                    <div>æ¸…æ½”åº¦</div>
                </div>
                <div class="resource">
                    <div>â° æ®‹ã‚Šæ™‚é–“</div>
                    <div class="resource-value" id="time">12</div>
                    <div>ãƒ¶æœˆ</div>
                </div>
            </div>

            <!-- ãƒ•ã‚§ãƒ¼ã‚º1: èª²é¡Œåˆ†æ -->
            <div class="action-panel" id="phase1Panel">
                <h3>ğŸ“Š ç¾çŠ¶åˆ†æ</h3>
                <p>ãƒ«ãƒ¯ãƒ³ãƒ€ã®ãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯ã”ã¿å•é¡Œã‚’èª¿æŸ»ã—ã¾ã—ã‚‡ã†</p>
                
                <div class="real-data-popup">
                    <strong>ğŸ‡·ğŸ‡¼ ãƒ«ãƒ¯ãƒ³ãƒ€ã®å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿:</strong><br>
                    â€¢ 2008å¹´ã«ãƒ“ãƒ‹ãƒ¼ãƒ«è¢‹ã‚’å…¨é¢ç¦æ­¢<br>
                    â€¢ ã”ã¿ã®ãƒã‚¤æ¨ã¦ã«ã¯ç½°é‡‘<br>
                    â€¢ ç¾åœ¨ã¯ã€Œã‚¢ãƒ•ãƒªã‚«ã§æœ€ã‚‚æ¸…æ½”ãªéƒ½å¸‚ã€ã«<br>
                    â€¢ è¦³å…‰å®¢ãŒå¢—åŠ ã—çµŒæ¸ˆåŠ¹æœã‚‚
                </div>

                <div class="action-grid">
                    <div class="action-card" onclick="analyzeData('waste')">
                        <h4>ğŸ—‘ï¸ ã”ã¿ç™ºç”Ÿé‡èª¿æŸ»</h4>
                        <p>ãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯ã”ã¿ã®å®Ÿæ…‹ã‚’æŠŠæ¡</p>
                    </div>
                    <div class="action-card" onclick="analyzeData('economic')">
                        <h4>ğŸ’¼ çµŒæ¸ˆå½±éŸ¿åˆ†æ</h4>
                        <p>ãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯ç”£æ¥­ã¸ã®å½±éŸ¿ã‚’èª¿æŸ»</p>
                    </div>
                    <div class="action-card" onclick="analyzeData('public')">
                        <h4>ğŸ‘¥ å¸‚æ°‘æ„è­˜èª¿æŸ»</h4>
                        <p>å¸‚æ°‘ã®ç’°å¢ƒæ„è­˜ã‚’æŠŠæ¡</p>
                    </div>
                    <div class="action-card" onclick="analyzeData('international')">
                        <h4>ğŸŒ å›½éš›äº‹ä¾‹ç ”ç©¶</h4>
                        <p>ä»–å›½ã®æˆåŠŸäº‹ä¾‹ã‚’èª¿æŸ»</p>
                    </div>
                </div>

                <button class="control-button" onclick="completePhase(1)" id="phase1Button" disabled>
                    åˆ†æå®Œäº† â†’ æ¬¡ã¸
                </button>
            </div>

            <!-- ãƒ•ã‚§ãƒ¼ã‚º2: å¯¾ç­–è¨ˆç”» -->
            <div class="action-panel" id="phase2Panel" style="display: none;">
                <h3>ğŸ“ å¯¾ç­–è¨ˆç”»ã®ç«‹æ¡ˆ</h3>
                <p>ãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯ã”ã¿å•é¡Œã®è§£æ±ºç­–ã‚’é¸æŠã—ã¦ãã ã•ã„</p>

                <div class="action-grid">
                    <div class="action-card" onclick="selectSolution('ban')">
                        <h4>ğŸš« å…¨é¢ç¦æ­¢æ”¿ç­–</h4>
                        <p>ãƒ“ãƒ‹ãƒ¼ãƒ«è¢‹ã®è£½é€ ãƒ»ä½¿ç”¨ã‚’å…¨é¢ç¦æ­¢</p>
                        <div class="progress-container">
                            <div>åŠ¹æœäºˆæ¸¬</div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 80%"></div>
                            </div>
                            <div>ç’°å¢ƒ: â­ï¸â­ï¸â­ï¸â­ï¸ | çµŒæ¸ˆ: â­ï¸â­ï¸</div>
                        </div>
                    </div>
                    <div class="action-card" onclick="selectSolution('tax')">
                        <h4>ğŸ’° èª²ç¨æ”¿ç­–</h4>
                        <p>ãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯è£½å“ã«ç’°å¢ƒç¨ã‚’èª²ã™</p>
                        <div class="progress-container">
                            <div>åŠ¹æœäºˆæ¸¬</div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 60%"></div>
                            </div>
                            <div>ç’°å¢ƒ: â­ï¸â­ï¸â­ï¸ | çµŒæ¸ˆ: â­ï¸â­ï¸â­ï¸</div>
                        </div>
                    </div>
                    <div class="action-card" onclick="selectSolution('recycle')">
                        <h4>â™»ï¸ ãƒªã‚µã‚¤ã‚¯ãƒ«æ¨é€²</h4>
                        <p>ãƒªã‚µã‚¤ã‚¯ãƒ«æ–½è¨­ã®æ•´å‚™ã¨æ™®åŠ</p>
                        <div class="progress-container">
                            <div>åŠ¹æœäºˆæ¸¬</div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 50%"></div>
                            </div>
                            <div>ç’°å¢ƒ: â­ï¸â­ï¸â­ï¸ | çµŒæ¸ˆ: â­ï¸â­ï¸â­ï¸â­ï¸</div>
                        </div>
                    </div>
                    <div class="action-card" onclick="selectSolution('alternative')">
                        <h4>ğŸŒ¿ ä»£æ›¿å“é–‹ç™º</h4>
                        <p>ç’°å¢ƒã«å„ªã—ã„ä»£æ›¿ç´ æã®é–‹ç™ºæ”¯æ´</p>
                        <div class="progress-container">
                            <div>åŠ¹æœäºˆæ¸¬</div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 40%"></div>
                            </div>
                            <div>ç’°å¢ƒ: â­ï¸â­ï¸ | çµŒæ¸ˆ: â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸</div>
                        </div>
                    </div>
                </div>

                <button class="control-button" onclick="completePhase(2)" id="phase2Button" disabled>
                    è¨ˆç”»ç¢ºå®š â†’ å®Ÿè¡Œã¸
                </button>
            </div>

            <!-- é€²æ—è¡¨ç¤º -->
            <div class="progress-container">
                <div>ãƒŸãƒƒã‚·ãƒ§ãƒ³é€²æ—: ãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯ã”ã¿ã®å‰Šæ¸›</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="missionProgress" style="width: 20%"></div>
                </div>
                <div id="progressText">ç¾åœ¨: 20% / ç›®æ¨™: 80%</div>
            </div>

            <div style="margin-top: 20px;">
                <h4>ğŸ† SDGsç›®æ¨™</h4>
                <div>
                    <span class="sdgs-badge">11: æŒç¶šå¯èƒ½ãªéƒ½å¸‚</span>
                    <span class="sdgs-badge">12: ã¤ãã‚‹è²¬ä»» ã¤ã‹ã†è²¬ä»»</span>
                    <span class="sdgs-badge">14: æµ·ã®è±Šã‹ã•</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ã‚²ãƒ¼ãƒ çŠ¶æ…‹
        const gameState = {
            currentPhase: 1,
            budget: 1000000,
            support: 45,
            political: 60,
            environment: 30,
            time: 12,
            analysisCompleted: 0,
            selectedSolution: null,
            missionProgress: 20
        };

        // åˆ†æãƒ‡ãƒ¼ã‚¿ã®çŠ¶æ…‹
        const analysisState = {
            waste: false,
            economic: false,
            public: false,
            international: false
        };

        function analyzeData(type) {
            if (!analysisState[type]) {
                analysisState[type] = true;
                gameState.analysisCompleted++;
                
                const messages = {
                    waste: "ğŸ—‘ï¸ ã”ã¿ç™ºç”Ÿé‡: ãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯ã”ã¿ãŒè¡—ã‚’æ±šæŸ“ã—ã¦ã„ã‚‹å®Ÿæ…‹ã‚’ç¢ºèª",
                    economic: "ğŸ’¼ çµŒæ¸ˆå½±éŸ¿: ãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯ç”£æ¥­å¾“äº‹è€…ã¸ã®å½±éŸ¿ã‚’æŠŠæ¡",
                    public: "ğŸ‘¥ å¸‚æ°‘æ„è­˜: å¸‚æ°‘ã®ç’°å¢ƒæ„è­˜ãŒé«˜ã„ã“ã¨ã‚’ç¢ºèª",
                    international: "ğŸŒ å›½éš›äº‹ä¾‹: ä»–å›½ã®æˆåŠŸäº‹ä¾‹ã‹ã‚‰å­¦ã¶"
                };
                
                showNotification(`âœ… ${messages[type]}`);
                
                // åˆ†æå®Œäº†ãƒã‚§ãƒƒã‚¯
                if (gameState.analysisCompleted === 4) {
                    document.getElementById('phase1Button').disabled = false;
                    showNotification('ğŸ‰ ã™ã¹ã¦ã®åˆ†æãŒå®Œäº†ã—ã¾ã—ãŸï¼');
                }
            }
        }

        function selectSolution(solution) {
            gameState.selectedSolution = solution;
            
            // é¸æŠçŠ¶æ…‹ã®è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
            document.querySelectorAll('.action-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.target.classList.add('selected');
            
            document.getElementById('phase2Button').disabled = false;
            
            const solutionNames = {
                ban: 'å…¨é¢ç¦æ­¢æ”¿ç­–',
                tax: 'èª²ç¨æ”¿ç­–', 
                recycle: 'ãƒªã‚µã‚¤ã‚¯ãƒ«æ¨é€²',
                alternative: 'ä»£æ›¿å“é–‹ç™º'
            };
            
            showNotification(`ğŸ“ è§£æ±ºç­–ã‚’é¸æŠ: ${solutionNames[solution]}`);
        }

        function completePhase(phase) {
            // ç¾åœ¨ã®ãƒ•ã‚§ãƒ¼ã‚ºã‚’éè¡¨ç¤º
            document.getElementById(`phase${phase}Panel`).style.display = 'none';
            document.getElementById(`phase${phase}`).classList.remove('active');
            
            // æ¬¡ã®ãƒ•ã‚§ãƒ¼ã‚ºã‚’è¡¨ç¤º
            const nextPhase = phase + 1;
            if (nextPhase <= 4) {
                document.getElementById(`phase${nextPhase}Panel`).style.display = 'block';
                document.getElementById(`phase${nextPhase}`).classList.add('active');
                
                if (phase === 1) {
                    showNotification('ğŸ“Š åˆ†æå®Œäº†ï¼è§£æ±ºç­–ã‚’è¨ˆç”»ã—ã¾ã—ã‚‡ã†');
                } else if (phase === 2) {
                    showNotification('ğŸ—ï¸ è¨ˆç”»ç¢ºå®šï¼æ”¿ç­–ã‚’å®Ÿè¡Œã«ç§»ã—ã¾ã—ã‚‡ã†');
                    startExecutionPhase();
                }
            } else {
                // ã‚²ãƒ¼ãƒ ã‚¯ãƒªã‚¢
                showNotification('ğŸ‰ ãƒŸãƒƒã‚·ãƒ§ãƒ³å®Œäº†ï¼ãƒ«ãƒ¯ãƒ³ãƒ€ã®ãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯å•é¡Œã‚’è§£æ±ºã—ã¾ã—ãŸ');
            }
        }

        function startExecutionPhase() {
            // å®Ÿè¡Œãƒ•ã‚§ãƒ¼ã‚ºã®ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆç°¡æ˜“å®Ÿè£…ï¼‰
            let progress = 20;
            const interval = setInterval(() => {
                progress += 5;
                gameState.missionProgress = progress;
                document.getElementById('missionProgress').style.width = `${progress}%`;
                document.getElementById('progressText').textContent = `ç¾åœ¨: ${progress}% / ç›®æ¨™: 80%`;
                
                // ãƒªã‚½ãƒ¼ã‚¹æ›´æ–°
                gameState.environment = Math.min(100, gameState.environment + 3);
                gameState.support = Math.min(100, gameState.support + 2);
                gameState.budget -= 50000;
                gameState.time -= 1;
                
                updateResourceDisplay();
                
                if (progress >= 80 || gameState.time <= 0) {
                    clearInterval(interval);
                    if (progress >= 80) {
                        showNotification('ğŸŠ æˆåŠŸï¼ãƒ«ãƒ¯ãƒ³ãƒ€ã¯ç¾ã—ã„ç’°å¢ƒå›½å®¶ã«ãªã‚Šã¾ã—ãŸ');
                    } else {
                        showNotification('â° æ™‚é–“åˆ‡ã‚Œ... ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã—ã¾ã—ã‚‡ã†');
                    }
                }
            }, 1000);
        }

        function updateResourceDisplay() {
            document.getElementById('budget').textContent = gameState.budget.toLocaleString();
            document.getElementById('support').textContent = gameState.support + '%';
            document.getElementById('political').textContent = gameState.political + '%';
            document.getElementById('environment').textContent = gameState.environment + '%';
            document.getElementById('time').textContent = gameState.time;
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'floating-notification';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => notification.remove(), 4000);
        }

        // åˆæœŸåŒ–
        window.addEventListener('load', () => {
            updateResourceDisplay();
            showNotification('ğŸ‡·ğŸ‡¼ ãƒ«ãƒ¯ãƒ³ãƒ€ãƒŸãƒƒã‚·ãƒ§ãƒ³é–‹å§‹ï¼ãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯ã”ã¿å•é¡Œã‚’è§£æ±ºã›ã‚ˆ');
        });
    </script>
</body>
</html>            box-shadow: 0 10px 25px rgba(116, 185, 255, 0.4);
        }
        .district.active {
            background: linear-gradient(135deg, #00b894, #00a085);
        }
        .landmark {
            position: absolute;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px 15px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            font-weight: bold;
        }
        .skytree { top: 20%; left: 70%; }
        .imperial-palace { top: 40%; left: 40%; }
        .tokyo-station { top: 50%; left: 50%; }
        .tokyo-bay { bottom: 20%; left: 60%; }
        .mission-panel {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        .mission-progress {
            background: rgba(116, 185, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }
        .progress-bar {
            height: 12px;
            background: #ecf0f1;
            border-radius: 6px;
            margin: 10px 0;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00b894, #fdcb6e);
            border-radius: 6px;
            transition: width 0.5s ease;
        }
        .world-events {
            background: rgba(253, 203, 110, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }
        .event-card {
            background: white;
            border: 2px solid #fdcb6e;
            border-radius: 12px;
            padding: 15px;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .event-card:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(253, 203, 110, 0.3);
        }
        .action-panel {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        .action-button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        .action-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }
        .story-dialog {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            display: none;
        }
        .story-dialog.active {
            display: block;
            animation: slideUp 0.5s ease;
        }
        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .sdgs-badge {
            display: inline-block;
            background: #FFD700;
            color: #000;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: bold;
            margin: 2px;
        }
        .real-data {
            background: rgba(116, 185, 255, 0.1);
            border-left: 4px solid #74b9ff;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
            font-size: 14px;
        }
        .floating-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #00b894, #00a085);
            color: white;
            padding: 15px 25px;
            border-radius: 15px;
            z-index: 1000;
            animation: slideInRight 0.5s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <div class="header">
            <h1>ğŸ™ï¸ æ±äº¬SDGsãƒŸãƒƒã‚·ãƒ§ãƒ³</h1>
            <p>ã‚«ãƒ¼ãƒœãƒ³ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ©ãƒ«2030ã¸ã®æŒ‘æˆ¦ - ä¸–ç•Œã®çŸ¥æµã‚’æ´»ç”¨ã›ã‚ˆï¼</p>
        </div>

        <!-- ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒ€ã‚¤ã‚¢ãƒ­ã‚° -->
        <div class="story-dialog active" id="introDialog">
            <h2>ğŸ—¼ æ±äº¬ãƒŸãƒƒã‚·ãƒ§ãƒ³é–‹å§‹</h2>
            <p>2030å¹´ã€‚æ±äº¬ã¯ã‚«ãƒ¼ãƒœãƒ³ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ©ãƒ«é”æˆã«å‘ã‘ã¦å¤§ããªèª²é¡Œã«ç›´é¢ã—ã¦ã„ã¾ã™ã€‚</p>
            <div class="real-data">
                <strong>å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿:</strong> æ±äº¬éƒ½ã®2030å¹´ç›®æ¨™ã¯CO2æ’å‡ºé‡50%å‰Šæ¸›ï¼ˆ2000å¹´æ¯”ï¼‰
            </div>
            <p>ã‚ãªãŸã¯æŒç¶šå¯èƒ½ãªéƒ½å¸‚è¨ˆç”»ã®å°‚é–€å®¶ã¨ã—ã¦ã€ä¸–ç•Œå„å›½ã®æˆåŠŸäº‹ä¾‹ã‚’å‚è€ƒã«ã—ãªãŒã‚‰æ±äº¬ã®å¤‰é©ã‚’å°ãã¾ã™ã€‚</p>
            <button class="action-button" onclick="startMission()">ãƒŸãƒƒã‚·ãƒ§ãƒ³é–‹å§‹</button>
        </div>

        <!-- ãƒ¡ã‚¤ãƒ³ã‚²ãƒ¼ãƒ ã‚¨ãƒªã‚¢ -->
        <div class="tokyo-map">
            <!-- æ±äº¬ãƒãƒƒãƒ— -->
            <div class="map-area">
                <h3>ğŸ—¾ æ±äº¬23åŒºãƒãƒƒãƒ—</h3>
                <div class="landmark skytree">ğŸ™ï¸ æ±äº¬ã‚¹ã‚«ã‚¤ãƒ„ãƒªãƒ¼</div>
                <div class="landmark imperial-palace">ğŸ¯ çš‡å±…</div>
                <div class="landmark tokyo-station">ğŸš‰ æ±äº¬é§…</div>
                <div class="landmark tokyo-bay">ğŸŒŠ æ±äº¬æ¹¾</div>
                
                <div class="tokyo-districts">
                    <div class="district" onclick="selectDistrict('åƒä»£ç”°åŒº')">
                        <h4>åƒä»£ç”°åŒº</h4>
                        <div>ã‚ªãƒ•ã‚£ã‚¹é›†ä¸­</div>
                    </div>
                    <div class="district" onclick="selectDistrict('æ¸¯åŒº')">
                        <h4>æ¸¯åŒº</h4>
                        <div>ãƒ“ã‚¸ãƒã‚¹ä¸­å¿ƒ</div>
                    </div>
                    <div class="district" onclick="selectDistrict('æ¸‹è°·åŒº')">
                        <h4>æ¸‹è°·åŒº</h4>
                        <div>è‹¥è€…æ–‡åŒ–</div>
                    </div>
                    <div class="district" onclick="selectDistrict('æ±Ÿæ±åŒº')">
                        <h4>æ±Ÿæ±åŒº</h4>
                        <div>è‡¨æµ·éƒ¨</div>
                    </div>
                </div>

                <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ -->
                <div class="action-panel">
                    <button class="action-button" onclick="takeAction('solar')">â˜€ï¸ å¤ªé™½å…‰æ¨é€²</button>
                    <button class="action-button" onclick="takeAction('wind')">ğŸŒ¬ï¸ é¢¨åŠ›å°å…¥</button>
                    <button class="action-button" onclick="takeAction('transport')">ğŸš† äº¤é€šæ”¹é©</button>
                    <button class="action-button" onclick="takeAction('building')">ğŸ¢ çœã‚¨ãƒå»ºç‰©</button>
                </div>
            </div>

            <!-- ãƒŸãƒƒã‚·ãƒ§ãƒ³ãƒ‘ãƒãƒ« -->
            <div class="mission-panel">
                <h3>ğŸ¯ ãƒŸãƒƒã‚·ãƒ§ãƒ³é€²æ—</h3>
                <div class="mission-progress">
                    <div>CO2å‰Šæ¸›ç›®æ¨™: 50%</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="co2Progress" style="width: 20%"></div>
                    </div>
                    <div>ç¾åœ¨: <span id="currentCO2">20%</span> / ç›®æ¨™: 50%</div>
                </div>

                <div class="world-events">
                    <h4>ğŸŒ ä¸–ç•Œã®äº‹ä¾‹</h4>
                    <div class="event-card" onclick="learnFromWorld('germany')">
                        <strong>ğŸ‡©ğŸ‡ª ãƒ‰ã‚¤ãƒ„ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼è»¢æ›</strong>
                        <div style="font-size: 12px; margin-top: 5px;">å†ç”Ÿå¯èƒ½ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¨é€²ã®æˆåŠŸäº‹ä¾‹</div>
                    </div>
                    <div class="event-card" onclick="learnFromWorld('singapore')">
                        <strong>ğŸ‡¸ğŸ‡¬ ã‚·ãƒ³ã‚¬ãƒãƒ¼ãƒ«ã®æ°´ç®¡ç†</strong>
                        <div style="font-size: 12px; margin-top: 5px;">é™ã‚‰ã‚ŒãŸè³‡æºã®æœ‰åŠ¹æ´»ç”¨</div>
                    </div>
                    <div class="event-card" onclick="learnFromWorld('denmark')">
                        <strong>ğŸ‡©ğŸ‡° ãƒ‡ãƒ³ãƒãƒ¼ã‚¯ã®è‡ªè»¢è»Šéƒ½å¸‚</strong>
                        <div style="font-size: 12px; margin-top: 5px;">æŒç¶šå¯èƒ½ãªäº¤é€šã‚·ã‚¹ãƒ†ãƒ </div>
                    </div>
                </div>

                <div style="margin-top: 20px;">
                    <h4>ğŸ† SDGsç›®æ¨™</h4>
                    <div>
                        <span class="sdgs-badge">7: ã‚¨ãƒãƒ«ã‚®ãƒ¼</span>
                        <span class="sdgs-badge">11: æŒç¶šå¯èƒ½ãªéƒ½å¸‚</span>
                        <span class="sdgs-badge">13: æ°—å€™å¤‰å‹•</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ã‚²ãƒ¼ãƒ çŠ¶æ…‹
        const gameState = {
            currentDistrict: null,
            co2Reduction: 20,
            budget: 1000000,
            knowledge: {
                germany: false,
                singapore: false,
                denmark: false
            },
            actions: [],
            turn: 1
        };

        // ä¸–ç•Œã®äº‹ä¾‹ãƒ‡ãƒ¼ã‚¿
        const worldExamples = {
            germany: {
                title: "ğŸ‡©ğŸ‡ª ãƒ‰ã‚¤ãƒ„ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼è»¢æ›ï¼ˆEnergiewendeï¼‰",
                content: `ãƒ‰ã‚¤ãƒ„ã¯2050å¹´ã¾ã§ã«å†ç”Ÿå¯èƒ½ã‚¨ãƒãƒ«ã‚®ãƒ¼80%ã‚’ç›®æ¨™ã«æ²ã’ã€ç€å®Ÿã«é€²å±•ã—ã¦ã„ã¾ã™ã€‚

<div class="real-data">
<strong>å®Ÿéš›ã®æˆæœ:</strong>
â€¢ å†ç”Ÿå¯èƒ½ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¯”ç‡: 45% (2020å¹´)
â€¢ å¤ªé™½å…‰ç™ºé›»å®¹é‡: 54GW (ä¸–ç•Œç¬¬4ä½)
â€¢ é¢¨åŠ›ç™ºé›»: é™¸ä¸Š28GW, æ´‹ä¸Š7.7GW
</div>

<strong>å­¦ã¹ã‚‹æ•™è¨“:</strong>
â€¢ ç³»çµ±çš„ãªæ”¿ç­–ã®é‡è¦æ€§
â€¢ å¸‚æ°‘å‚åŠ ã®ä¿ƒé€²
â€¢ æŠ€è¡“é©æ–°ã®æ”¯æ´`,
                effect: "å¤ªé™½å…‰ãƒ»é¢¨åŠ›ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®åŠ¹ç‡+30%"
            },
            singapore: {
                title: "ğŸ‡¸ğŸ‡¬ ã‚·ãƒ³ã‚¬ãƒãƒ¼ãƒ«ã®æ°´è³‡æºç®¡ç†",
                content: `é™ã‚‰ã‚ŒãŸå›½åœŸã§æ°´è‡ªçµ¦ç‡ã‚’é«˜ã‚ã‚‹ãŸã‚ã®é©æ–°çš„ãªå–ã‚Šçµ„ã¿ã€‚

<div class="real-data">
<strong>NEWaterã®æˆåŠŸ:</strong>
â€¢ ä¸‹æ°´ã®é«˜åº¦å†ç”Ÿåˆ©ç”¨ã§é£²æ–™æ°´ã‚’ç”Ÿç”£
â€¢ æ°´è‡ªçµ¦ç‡: 30% â†’ 60%ç›®æ¨™
â€¢ ä¸–ç•Œæœ‰æ•°ã®æ°´å‡¦ç†æŠ€è¡“ã‚’ç¢ºç«‹
</div>

<strong>å­¦ã¹ã‚‹æ•™è¨“:</strong>
â€¢ æŠ€è¡“é©æ–°ã«ã‚ˆã‚‹èª²é¡Œè§£æ±º
â€¢ çµ±åˆçš„æ°´è³‡æºç®¡ç†
â€¢ æŒç¶šå¯èƒ½ãªéƒ½å¸‚è¨ˆç”»`,
                effect: "æ°´é–¢é€£ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®åŠ¹æœ+25%"
            },
            denmark: {
                title: "ğŸ‡©ğŸ‡° ã‚³ãƒšãƒ³ãƒãƒ¼ã‚²ãƒ³ã®è‡ªè»¢è»Šéƒ½å¸‚è¨ˆç”»",
                content: `ã€Œä¸–ç•Œä¸€ã®è‡ªè»¢è»Šéƒ½å¸‚ã€ã‚’ç›®æŒ‡ã™æŒç¶šå¯èƒ½ãªäº¤é€šæ”¿ç­–ã€‚

<div class="real-data">
<strong>é©šç•°çš„ãªæˆæœ:</strong>
â€¢ è‡ªè»¢è»Šé€šå‹¤ç‡: 45%
â€¢ å¸‚å†…ç§»å‹•ã®62%ãŒè‡ªè»¢è»Š
â€¢ CO2æ’å‡ºé‡ã®å¤§å¹…å‰Šæ¸›
</div>

<strong>å­¦ã¹ã‚‹æ•™è¨“:</strong>
â€¢ ã‚¤ãƒ³ãƒ•ãƒ©æ•´å‚™ã®é‡è¦æ€§
â€¢ æ–‡åŒ–ã®å¤‰å®¹ã‚’ä¿ƒã™æ”¿ç­–
â€¢ å¤šæ§˜ãªäº¤é€šæ‰‹æ®µã®çµ±åˆ`,
                effect: "äº¤é€šéƒ¨é–€ã®CO2å‰Šæ¸›åŠ¹æœ+40%"
            }
        };

        function startMission() {
            document.getElementById('introDialog').classList.remove('active');
            showNotification('ğŸ™ï¸ æ±äº¬ãƒŸãƒƒã‚·ãƒ§ãƒ³é–‹å§‹ï¼ä¸–ç•Œã®çŸ¥æµã‚’æ´»ç”¨ã—ã¾ã—ã‚‡ã†');
        }

        function selectDistrict(district) {
            gameState.currentDistrict = district;
            // åœ°åŒºé¸æŠã®è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
            document.querySelectorAll('.district').forEach(d => d.classList.remove('active'));
            event.target.classList.add('active');
            
            showNotification(`ğŸ“ ${district}ã‚’é¸æŠã—ã¾ã—ãŸ`);
        }

        function takeAction(action) {
            if (!gameState.currentDistrict) {
                showNotification('âŒ ã¾ãšåœ°åŒºã‚’é¸æŠã—ã¦ãã ã•ã„');
                return;
            }

            let message = "";
            let co2Increase = 0;

            switch(action) {
                case 'solar':
                    message = `â˜€ï¸ ${gameState.currentDistrict}ã§å¤ªé™½å…‰æ¨é€²ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹å§‹`;
                    co2Increase = 3;
                    break;
                case 'wind':
                    message = `ğŸŒ¬ï¸ ${gameState.currentDistrict}ã«é¢¨åŠ›ç™ºé›»ã‚’å°å…¥`;
                    co2Increase = 4;
                    break;
                case 'transport':
                    message = `ğŸš† ${gameState.currentDistrict}ã®äº¤é€šã‚·ã‚¹ãƒ†ãƒ ã‚’æ”¹é©`;
                    co2Increase = 5;
                    break;
                case 'building':
                    message = `ğŸ¢ ${gameState.currentDistrict}ã§çœã‚¨ãƒå»ºç‰©åŸºæº–ã‚’å°å…¥`;
                    co2Increase = 2;
                    break;
            }

            // çŸ¥è­˜ãƒœãƒ¼ãƒŠã‚¹ã®é©ç”¨
            if (gameState.knowledge.germany && (action === 'solar' || action === 'wind')) {
                co2Increase += 1;
                message += " (ãƒ‰ã‚¤ãƒ„ã®çŸ¥æµã‚’æ´»ç”¨!)";
            }
            if (gameState.knowledge.denmark && action === 'transport') {
                co2Increase += 2;
                message += " (ãƒ‡ãƒ³ãƒãƒ¼ã‚¯ã®çŸ¥æµã‚’æ´»ç”¨!)";
            }

            gameState.co2Reduction = Math.min(50, gameState.co2Reduction + co2Increase);
            gameState.actions.push({ action, district: gameState.currentDistrict, turn: gameState.turn });
            
            updateProgress();
            showNotification(`âœ… ${message} - CO2å‰Šæ¸›: +${co2Increase}%`);

            // ã‚¿ãƒ¼ãƒ³é€²è¡Œ
            gameState.turn++;
            if (gameState.turn % 3 === 0) {
                showWorldEvent();
            }
        }

        function learnFromWorld(country) {
            const example = worldExamples[country];
            if (!example) return;

            const dialog = document.getElementById('introDialog');
            dialog.innerHTML = `
                <h2>${example.title}</h2>
                <div style="margin: 20px 0; line-height: 1.6;">${example.content}</div>
                <div class="real-data">${example.effect}</div>
                <button class="action-button" onclick="applyKnowledge('${country}')">ã“ã®çŸ¥æµã‚’æ´»ç”¨ã™ã‚‹</button>
                <button class="action-button" style="background: linear-gradient(135deg, #95a5a6, #7f8c8d);" onclick="closeDialog()">é–‰ã˜ã‚‹</button>
            `;
            dialog.classList.add('active');
        }

        function applyKnowledge(country) {
            gameState.knowledge[country] = true;
            showNotification(`ğŸ“ ${worldExamples[country].title}ã®çŸ¥æµã‚’ç²å¾—ã—ã¾ã—ãŸï¼`);
            closeDialog();
        }

        function closeDialog() {
            document.getElementById('introDialog').classList.remove('active');
        }

        function showWorldEvent() {
            const events = [
                "ğŸŒ¡ï¸ ç†±æ³¢æ¥è¥²ï¼å†·æˆ¿éœ€è¦ãŒæ€¥å¢—",
                "ğŸ’¼ å›½éš›ä¼šè­°é–‹å‚¬ï¼ç’°å¢ƒæŠ€è¡“ã®ãƒãƒ£ãƒ³ã‚¹",
                "ğŸš— äº¤é€šæ¸‹æ»ãŒæ·±åˆ»åŒ–",
                "ğŸŒ¿ å¸‚æ°‘ã®ç’°å¢ƒæ„è­˜ãŒé«˜ã¾ã‚‹"
            ];
            const event = events[Math.floor(Math.random() * events.length)];
            showNotification(`ğŸ“¢ ã‚¤ãƒ™ãƒ³ãƒˆ: ${event}`);
        }

        function updateProgress() {
            document.getElementById('co2Progress').style.width = `${gameState.co2Reduction}%`;
            document.getElementById('currentCO2').textContent = `${gameState.co2Reduction}%`;
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'floating-notification';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => notification.remove(), 4000);
        }

        // åˆæœŸåŒ–
        window.addEventListener('load', () => {
            updateProgress();
        });
    </script>
</body>
</html>            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }
        .city-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .city-flag {
            font-size: 32px;
        }
        .city-details h2 {
            color: #2c3e50;
            margin-bottom: 4px;
        }
        .city-details .mission {
            font-size: 14px;
            color: #7f8c8d;
        }
        .resources {
            display: flex;
            gap: 20px;
        }
        .resource {
            text-align: center;
        }
        .resource-value {
            font-size: 20px;
            font-weight: bold;
            color: #2c3e50;
        }
        .resource-label {
            font-size: 12px;
            color: #7f8c8d;
        }
        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr 300px;
            gap: 15px;
        }
        .panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            overflow-y: auto;
        }
        .city-view {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
        }
        #city3d {
            width: 100%;
            height: 100%;
        }
        .construction-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 15px 0;
        }
        .building-option {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            border: none;
            border-radius: 15px;
            padding: 15px 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .building-option:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(116, 185, 255, 0.4);
        }
        .building-icon {
            font-size: 24px;
            margin-bottom: 5px;
        }
        .tech-tree {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px;
            margin: 10px 0;
        }
        .tech-level {
            margin-bottom: 15px;
        }
        .tech-items {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        .tech-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 12px;
            border-radius: 10px;
            font-size: 12px;
        }
        .event-log {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px;
            margin: 10px 0;
            max-height: 200px;
            overflow-y: auto;
        }
        .event-item {
            padding: 8px;
            margin: 5px 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            font-size: 12px;
        }
        .control-bar {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }
        .control-button {
            background: linear-gradient(135deg, #00b894, #00a085);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 15px;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        .control-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 184, 148, 0.4);
        }
        .turn-info {
            text-align: center;
        }
        .turn-number {
            font-size: 24px;
            font-weight: bold;
            color: #2c3e50;
        }
        .progress-container {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 8px;
            margin: 10px 0;
        }
        .progress-bar {
            height: 8px;
            background: linear-gradient(90deg, #00b894, #fdcb6e, #e17055);
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        .sdgs-badge {
            display: inline-block;
            background: #FFD700;
            color: #000;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: bold;
            margin: 2px;
        }
        .floating-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #00b894, #00a085);
            color: white;
            padding: 15px 20px;
            border-radius: 15px;
            z-index: 1000;
            animation: slideInRight 0.5s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .construction-effect {
            position: absolute;
            width: 60px;
            height: 60px;
            background: radial-gradient(circle, #FFD700 20%, transparent 70%);
            border-radius: 50%;
            pointer-events: none;
            z-index: 100;
            animation: constructPulse 1s ease-out;
        }
        @keyframes constructPulse {
            0% { transform: scale(0.8); opacity: 1; }
            100% { transform: scale(2); opacity: 0; }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼: éƒ½å¸‚æƒ…å ±ã¨è³‡æº -->
        <div class="header">
            <div class="city-info">
                <div class="city-flag">ğŸ‡¯ğŸ‡µ</div>
                <div class="city-details">
                    <h2>æ±äº¬ãƒŸãƒƒã‚·ãƒ§ãƒ³</h2>
                    <div class="mission">ã‚«ãƒ¼ãƒœãƒ³ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ©ãƒ«2030 - CO2æ’å‡ºé‡70%å‰Šæ¸›</div>
                </div>
            </div>
            <div class="resources">
                <div class="resource">
                    <div class="resource-value" id="budget">2,500,000</div>
                    <div class="resource-label">äºˆç®—</div>
                </div>
                <div class="resource">
                    <div class="resource-value" id="energy">78%</div>
                    <div class="resource-label">ã‚¨ãƒãƒ«ã‚®ãƒ¼</div>
                </div>
                <div class="resource">
                    <div class="resource-value" id="environment">65%</div>
                    <div class="resource-label">ç’°å¢ƒ</div>
                </div>
                <div class="resource">
                    <div class="resource-value" id="water">85%</div>
                    <div class="resource-label">æ°´è³‡æº</div>
                </div>
            </div>
        </div>

        <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
        <div class="main-content">
            <!-- å·¦ãƒ‘ãƒãƒ«: å»ºè¨­ãƒ¡ãƒ‹ãƒ¥ãƒ¼ -->
            <div class="panel">
                <h3 style="color: #2c3e50; margin-bottom: 20px;">ğŸ—ï¸ æ–½è¨­å»ºè¨­</h3>
                
                <div class="construction-grid">
                    <div class="building-option" onclick="constructBuilding('residential')">
                        <div class="building-icon">ğŸ </div>
                        <div>ä½å®…</div>
                        <div style="font-size: 10px; opacity: 0.8;">äººå£+1000</div>
                    </div>
                    <div class="building-option" onclick="constructBuilding('commercial')">
                        <div class="building-icon">ğŸª</div>
                        <div>å•†æ¥­</div>
                        <div style="font-size: 10px; opacity: 0.8;">åå…¥+5000</div>
                    </div>
                    <div class="building-option" onclick="constructBuilding('solar')">
                        <div class="building-icon">â˜€ï¸</div>
                        <div>å¤ªé™½å…‰</div>
                        <div style="font-size: 10px; opacity: 0.8;">ã‚¨ãƒãƒ«ã‚®ãƒ¼+15%</div>
                    </div>
                    <div class="building-option" onclick="constructBuilding('wind')">
                        <div class="building-icon">ğŸŒ¬ï¸</div>
                        <div>é¢¨åŠ›</div>
                        <div style="font-size: 10px; opacity: 0.8;">ã‚¨ãƒãƒ«ã‚®ãƒ¼+20%</div>
                    </div>
                    <div class="building-option" onclick="constructBuilding('park')">
                        <div class="building-icon">ğŸŒ³</div>
                        <div>å…¬åœ’</div>
                        <div style="font-size: 10px; opacity: 0.8;">ç’°å¢ƒ+10%</div>
                    </div>
                    <div class="building-option" onclick="constructBuilding('water_plant')">
                        <div class="building-icon">ğŸ’§</div>
                        <div>æµ„æ°´å ´</div>
                        <div style="font-size: 10px; opacity: 0.8;">æ°´è³‡æº+25%</div>
                    </div>
                    <div class="building-option" onclick="constructBuilding('recycling')">
                        <div class="building-icon">â™»ï¸</div>
                        <div>ãƒªã‚µã‚¤ã‚¯ãƒ«</div>
                        <div style="font-size: 10px; opacity: 0.8;">å»ƒæ£„ç‰©-15%</div>
                    </div>
                    <div class="building-option" onclick="constructBuilding('research')">
                        <div class="building-icon">ğŸ”¬</div>
                        <div>ç ”ç©¶æ‰€</div>
                        <div style="font-size: 10px; opacity: 0.8;">æŠ€è¡“+10%</div>
                    </div>
                </div>

                <div class="tech-tree">
                    <h4 style="color: #2c3e50; margin-bottom: 15px;">ğŸ”§ æŠ€è¡“ãƒ„ãƒªãƒ¼</h4>
                    <div class="tech-level">
                        <div style="font-size: 12px; margin-bottom: 8px; color: #7f8c8d;">ãƒ¬ãƒ™ãƒ«1</div>
                        <div class="tech-items">
                            <div class="tech-item">çœã‚¨ãƒå®¶é›»</div>
                            <div class="tech-item">å¤ªé™½å…‰ç™ºé›»</div>
                            <div class="tech-item">ãƒªã‚µã‚¤ã‚¯ãƒ«</div>
                        </div>
                    </div>
                    <div class="tech-level">
                        <div style="font-size: 12px; margin-bottom: 8px; color: #7f8c8d;">ãƒ¬ãƒ™ãƒ«2</div>
                        <div class="tech-items">
                            <div class="tech-item" style="opacity: 0.5;">ã‚¹ãƒãƒ¼ãƒˆã‚°ãƒªãƒƒãƒ‰</div>
                            <div class="tech-item" style="opacity: 0.5;">æ°´ãƒªã‚µã‚¤ã‚¯ãƒ«</div>
                            <div class="tech-item" style="opacity: 0.5;">é›»æ°—è‡ªå‹•è»Š</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ä¸­å¤®: 3Déƒ½å¸‚ãƒ“ãƒ¥ãƒ¼ -->
            <div class="city-view">
                <div id="city3d"></div>
                <div id="constructionEffects"></div>
            </div>

            <!-- å³ãƒ‘ãƒãƒ«: ãƒŸãƒƒã‚·ãƒ§ãƒ³ã¨ã‚¤ãƒ™ãƒ³ãƒˆ -->
            <div class="panel">
                <h3 style="color: #2c3e50; margin-bottom: 20px;">ğŸ¯ ãƒŸãƒƒã‚·ãƒ§ãƒ³é€²æ—</h3>
                
                <div class="progress-container">
                    <div style="display: flex; justify-content: space-between; font-size: 12px; margin-bottom: 5px;">
                        <span>CO2å‰Šæ¸›ç›®æ¨™</span>
                        <span>45% / 70%</span>
                    </div>
                    <div class="progress-bar" style="width: 64%"></div>
                </div>

                <div style="margin: 20px 0;">
                    <h4 style="color: #2c3e50; margin-bottom: 10px;">ğŸ† SDGsç›®æ¨™</h4>
                    <div>
                        <span class="sdgs-badge">7: ã‚¨ãƒãƒ«ã‚®ãƒ¼</span>
                        <span class="sdgs-badge">11: æŒç¶šå¯èƒ½ãªéƒ½å¸‚</span>
                        <span class="sdgs-badge">13: æ°—å€™å¤‰å‹•</span>
                    </div>
                </div>

                <div class="event-log">
                    <h4 style="color: #2c3e50; margin-bottom: 10px;">ğŸ“ ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°</h4>
                    <div class="event-item">ğŸ­ å·¥æ¥­åœ°åŒºã‚’å»ºè¨­ã—ã¾ã—ãŸ</div>
                    <div class="event-item">â˜€ï¸ å¤ªé™½å…‰ç™ºé›»æ‰€ãŒå®Œæˆ</div>
                    <div class="event-item">ğŸ’§ æ°´éœ€è¦ãŒ10%å¢—åŠ </div>
                    <div class="event-item">ğŸŒ¿ ç’°å¢ƒæŒ‡æ¨™ãŒæ”¹å–„ã—ã¾ã—ãŸ</div>
                </div>

                <div style="margin-top: 20px; padding: 15px; background: rgba(116, 185, 255, 0.1); border-radius: 10px;">
                    <h4 style="color: #2c3e50; margin-bottom: 8px;">ğŸŒ å›½éš›æŠ€è¡“</h4>
                    <div style="font-size: 12px; line-height: 1.4;">
                        ãƒ‰ã‚¤ãƒ„ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼è»¢æ›æŠ€è¡“ãŒåˆ©ç”¨å¯èƒ½
                        <span class="sdgs-badge" style="background: #74b9ff; margin-left: 5px;">æ–°ç€</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒãƒ¼ -->
        <div class="control-bar">
            <div class="turn-info">
                <div style="font-size: 14px; color: #7f8c8d;">ã‚¿ãƒ¼ãƒ³</div>
                <div class="turn-number" id="turn">5</div>
            </div>
            <button class="control-button" onclick="nextTurn()">
                â­ï¸ æ¬¡ã®ã‚¿ãƒ¼ãƒ³ã¸
            </button>
            <div style="text-align: right;">
                <div style="font-size: 14px; color: #7f8c8d;">äººå£</div>
                <div style="font-size: 20px; font-weight: bold; color: #2c3e50;" id="population">125,000</div>
            </div>
        </div>
    </div>

    <script>
        // =============================================
        // ğŸ® ã‚²ãƒ¼ãƒ ã‚¨ãƒ³ã‚¸ãƒ³ - å®Œå…¨å®Ÿè£…
        // =============================================

        class GlobalSDGsGame {
            constructor() {
                this.currentCity = 'tokyo';
                this.turn = 5;
                this.resources = {
                    budget: 2500000,
                    energy: 78,
                    environment: 65,
                    water: 85,
                    population: 125000
                };
                this.buildings = [];
                this.missions = {
                    tokyo: { target: 70, current: 45, name: 'CO2æ’å‡ºé‡70%å‰Šæ¸›' }
                };
                this.events = [];
                this.init();
            }

            init() {
                this.loadCityData();
                this.updateUI();
            }

            loadCityData() {
                // éƒ½å¸‚ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿
                const cities = {
                    tokyo: {
                        flag: 'ğŸ‡¯ğŸ‡µ',
                        name: 'æ±äº¬ãƒŸãƒƒã‚·ãƒ§ãƒ³',
                        mission: 'ã‚«ãƒ¼ãƒœãƒ³ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ©ãƒ«2030 - CO2æ’å‡ºé‡70%å‰Šæ¸›',
                        challenges: ['é«˜å¯†åº¦éƒ½å¸‚', 'åœŸåœ°ä¸è¶³', 'ã‚¨ãƒãƒ«ã‚®ãƒ¼éœ€è¦å¤§']
                    }
                };
                this.cityData = cities[this.currentCity];
            }

            constructBuilding(type) {
                const cost = this.getBuildingCost(type);
                if (this.resources.budget < cost) {
                    this.showNotification('âŒ äºˆç®—ãŒè¶³ã‚Šã¾ã›ã‚“');
                    return false;
                }

                this.resources.budget -= cost;
                this.applyBuildingEffects(type);
                
                const building = {
                    type,
                    turn: this.turn,
                    position: this.getRandomGridPosition()
                };
                this.buildings.push(building);

                this.addEvent(`ğŸ—ï¸ ${this.getBuildingName(type)}ã‚’å»ºè¨­ã—ã¾ã—ãŸ`);
                this.showNotification(`âœ… ${this.getBuildingName(type)}ã‚’å»ºè¨­ã—ã¾ã—ãŸ`);
                this.updateUI();
                return building;
            }

            getBuildingCost(type) {
                const costs = {
                    'residential': 100000,
                    'commercial': 150000,
                    'solar': 200000,
                    'wind': 250000,
                    'park': 50000,
                    'water_plant': 300000,
                    'recycling': 180000,
                    'research': 400000
                };
                return costs[type] || 0;
            }

            getBuildingName(type) {
                const names = {
                    'residential': 'ä½å®…åœ°åŒº',
                    'commercial': 'å•†æ¥­åœ°åŒº',
                    'solar': 'å¤ªé™½å…‰ç™ºé›»æ‰€',
                    'wind': 'é¢¨åŠ›ç™ºé›»æ‰€',
                    'park': 'å…¬åœ’',
                    'water_plant': 'æµ„æ°´å ´',
                    'recycling': 'ãƒªã‚µã‚¤ã‚¯ãƒ«ã‚»ãƒ³ã‚¿ãƒ¼',
                    'research': 'ç ”ç©¶æ‰€'
                };
                return names[type] || type;
            }

            applyBuildingEffects(type) {
                const effects = {
                    'residential': { population: 1000, budget: -5000 },
                    'commercial': { budget: 5000, energy: -5 },
                    'solar': { energy: 15, environment: 5 },
                    'wind': { energy: 20, environment: 8 },
                    'park': { environment: 10, budget: -2000 },
                    'water_plant': { water: 25, energy: -10 },
                    'recycling': { environment: 12, budget: 3000 },
                    'research': { budget: -8000 }
                };

                const effect = effects[type] || {};
                Object.keys(effect).forEach(key => {
                    if (this.resources[key] !== undefined) {
                        this.resources[key] += effect[key];
                        // å€¤ã‚’åˆ¶é™
                        if (key !== 'budget' && key !== 'population') {
                            this.resources[key] = Math.max(0, Math.min(100, this.resources[key]));
                        }
                    }
                });

                // ãƒŸãƒƒã‚·ãƒ§ãƒ³é€²æ—æ›´æ–°
                if (type === 'solar' || type === 'wind' || type === 'recycling') {
                    this.missions.tokyo.current = Math.min(70, this.missions.tokyo.current + 2);
                }
            }

            getRandomGridPosition() {
                return {
                    x: Math.floor(Math.random() * 8),
                    z: Math.floor(Math.random() * 8)
                };
            }

            nextTurn() {
                this.turn++;
                
                // ã‚¿ãƒ¼ãƒ³ã”ã¨ã®è‡ªç„¶ãªå¤‰åŒ–
                this.resources.energy = Math.max(0, this.resources.energy - 3);
                this.resources.water = Math.max(0, this.resources.water - 2);
                this.resources.population += Math.floor(this.resources.population * 0.02);
                this.resources.budget += Math.floor(this.resources.population * 0.8);
                
                // ãƒ©ãƒ³ãƒ€ãƒ ã‚¤ãƒ™ãƒ³ãƒˆ
                this.generateRandomEvent();
                
                this.addEvent(`ğŸ“Š ã‚¿ãƒ¼ãƒ³ ${this.turn} é–‹å§‹ - äººå£å¢—åŠ : ${Math.floor(this.resources.population * 0.02).toLocaleString()}äºº`);
                this.showNotification(`ğŸ”„ ã‚¿ãƒ¼ãƒ³ ${this.turn} ãŒå§‹ã¾ã‚Šã¾ã—ãŸ`);
                this.updateUI();
            }

            generateRandomEvent() {
                const events = [
                    { message: "ğŸŒ¡ï¸ ç†±æ³¢æ¥è¥²ï¼ã‚¨ãƒãƒ«ã‚®ãƒ¼éœ€è¦ãŒ15%å¢—åŠ ", effect: { energy: -10 } },
                    { message: "ğŸ’§ æ°´ä¸è¶³è­¦å‘Šï¼ç¯€æ°´å¯¾ç­–ãŒå¿…è¦", effect: { water: -15 } },
                    { message: "ğŸŒ¿ ç’°å¢ƒæ„è­˜ã®é«˜ã¾ã‚Šï¼ç’°å¢ƒæŒ‡æ¨™ãŒæ”¹å–„", effect: { environment: 8 } },
                    { message: "ğŸ’° çµŒæ¸ˆæˆé•·ï¼äºˆç®—åå…¥ãŒå¢—åŠ ", effect: { budget: 100000 } }
                ];
                
                const event = events[Math.floor(Math.random() * events.length)];
                this.addEvent(event.message);
                
                Object.keys(event.effect).forEach(key => {
                    if (this.resources[key] !== undefined) {
                        this.resources[key] += event.effect[key];
                    }
                });
            }

            addEvent(message) {
                this.events.unshift(message);
                if (this.events.length > 6) {
                    this.events.pop();
                }
            }

            showNotification(message) {
                const notification = document.createElement('div');
                notification.className = 'floating-notification';
                notification.textContent = message;
                document.body.appendChild(notification);
                
                setTimeout(() => notification.remove(), 3000);
            }

            showConstructionEffect(x, z) {
                const effectsContainer = document.getElementById('constructionEffects');
                const effect = document.createElement('div');
                effect.className = 'construction-effect';
                effect.style.left = `${12.5 + x * 12.5}%`;
                effect.style.top = `${12.5 + z * 12.5}%`;
                effectsContainer.appendChild(effect);
                
                setTimeout(() => effect.remove(), 1000);
            }

            updateUI() {
                // ãƒªã‚½ãƒ¼ã‚¹æ›´æ–°
                document.getElementById('budget').textContent = this.resources.budget.toLocaleString();
                document.getElementById('energy').textContent = this.resources.energy + '%';
                document.getElementById('environment').textContent = this.resources.environment + '%';
                document.getElementById('water').textContent = this.resources.water + '%';
                document.getElementById('population').textContent = this.resources.population.toLocaleString();
                document.getElementById('turn').textContent = this.turn;
                
                // é€²æ—ãƒãƒ¼æ›´æ–°
                const progress = (this.missions.tokyo.current / this.missions.tokyo.target) * 100;
                document.querySelector('.progress-bar').style.width = `${progress}%`;
                document.querySelector('.progress-container span:last-child').textContent = 
                    `${this.missions.tokyo.current}% / ${this.missions.tokyo.target}%`;
                
                // ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°æ›´æ–°
                const eventLog = document.querySelector('.event-log');
                eventLog.innerHTML = '<h4 style="color: #2c3e50; margin-bottom: 10px;">ğŸ“ ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°</h4>';
                this.events.forEach(event => {
                    const eventItem = document.createElement('div');
                    eventItem.className = 'event-item';
                    eventItem.textContent = event;
                    eventLog.appendChild(eventItem);
                });
            }
        }

        // =============================================
        // ğŸ® 3Déƒ½å¸‚ã‚¨ãƒ³ã‚¸ãƒ³
        // =============================================

        let scene, camera, renderer, controls;
        const game = new GlobalSDGsGame();

        function init3D() {
            // ã‚·ãƒ¼ãƒ³è¨­å®š
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x87CEEB);
            
            // ã‚«ãƒ¡ãƒ©è¨­å®š
            const container = document.getElementById('city3d');
            camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
            camera.position.set(8, 12, 8);
            camera.lookAt(0, 0, 0);
            
            // ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼è¨­å®š
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(container.clientWidth, container.clientHeight);
            renderer.shadowMap.enabled = true;
            container.appendChild(renderer.domElement);
            
            // ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«è¨­å®š
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            
            // ãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚°
            const ambientLight = new THREE.AmbientLight(0x404040, 0.6);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(10, 20, 5);
            directionalLight.castShadow = true;
            scene.add(directionalLight);
            
            // ã‚°ãƒªãƒƒãƒ‰åœ°é¢ã®ä½œæˆ
            createCityGrid();
            
            // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ—
            function animate() {
                requestAnimationFrame(animate);
                controls.update();
                renderer.render(scene, camera);
            }
            animate();
            
            window.addEventListener('resize', onWindowResize);
        }

        function createCityGrid() {
            // åœ°é¢
            const groundGeometry = new THREE.PlaneGeometry(16, 16);
            const groundMaterial = new THREE.MeshLambertMaterial({ color: 0x3d9970 });
            const ground = new THREE.Mesh(groundGeometry, groundMaterial);
            ground.rotation.x = -Math.PI / 2;
            ground.position.y = -0.1;
            scene.add(ground);
            
            // ã‚°ãƒªãƒƒãƒ‰ç·š
            const gridHelper = new THREE.GridHelper(16, 8, 0x000000, 0x000000);
            scene.add(gridHelper);
            
            // é“è·¯
            createRoads();
        }

        function createRoads() {
            const roadMaterial = new THREE.MeshLambertMaterial({ color: 0x333333 });
            
            // ç¸¦æ¨ªã®ä¸»è¦é“è·¯
            for (let i = -7; i <= 7; i += 2) {
                const roadGeometry = new THREE.PlaneGeometry(16, 0.5);
                const road1 = new THREE.Mesh(roadGeometry, roadMaterial);
                road1.rotation.x = -Math.PI / 2;
                road1.position.set(0, 0, i);
                
                const road2 = new THREE.Mesh(roadGeometry, roadMaterial);
                road2.rotation.x = -Math.PI / 2;
                road2.rotation.z = Math.PI / 2;
                road2.position.set(i, 0, 0);
                
                scene.add(road1);
                scene.add(road2);
            }
        }

        function create3DBuilding(type, x, z) {
            let geometry, material, color, height;
            const baseX = (x - 3.5) * 2;
            const baseZ = (z - 3.5) * 2;
            
            switch(type) {
                case 'residential':
                    geometry = new THREE.BoxGeometry(1.5, 1.2, 1.5);
                    color = 0xff6b6b;
                    height = 0.6;
                    break;
                case 'commercial':
                    geometry = new THREE.BoxGeometry(1.5, 1.8, 1.5);
                    color = 0xfdcb6e;
                    height = 0.9;
                    break;
                case 'solar':
                    geometry = new THREE.BoxGeometry(1.2, 0.2, 1.2);
                    color = 0xf9ca24;
                    height = 0.1;
                    break;
                case 'wind':
                    geometry = new THREE.CylinderGeometry(0.3, 0.4, 2, 6);
                    color = 0x74b9ff;
                    height = 1;
                    break;
                case 'park':
                    geometry = new THREE.BoxGeometry(1.8, 0.1, 1.8);
                    color = 0x00b894;
                    height = 0.05;
                    break;
                case 'water_plant':
                    geometry = new THREE.BoxGeometry(1.6, 1, 1.6);
                    color = 0x0984e3;
                    height = 0.5;
                    break;
                case 'recycling':
                    geometry = new THREE.BoxGeometry(1.4, 0.8, 1.4);
                    color = 0x00cec9;
                    height = 0.4;
                    break;
                case 'research':
                    geometry = new THREE.BoxGeometry(1.3, 1.5, 1.3);
                    color = 0xa29bfe;
                    height = 0.75;
                    break;
            }
            
            material = new THREE.MeshLambertMaterial({ color });
            const building = new THREE.Mesh(geometry, material);
            building.position.set(baseX, height, baseZ);
            building.castShadow = true;
            
            scene.add(building);
            return building;
        }

        // =============================================
        // ğŸ® ã‚²ãƒ¼ãƒ åˆ¶å¾¡é–¢æ•°
        // =============================================

        function constructBuilding(type) {
            const building = game.constructBuilding(type);
            if (building) {
                game.showConstructionEffect(building.position.x, building.position.z);
                setTimeout(() => {
                    create3DBuilding(type, building.position.x, building.position.z);
                }, 500);
            }
        }

        function nextTurn() {
            game.nextTurn();
        }

        function onWindowResize() {
            const container = document.getElementById('city3d');
            camera.aspect = container.clientWidth / container.clientHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(container.clientWidth, container.clientHeight);
        }

        // =============================================
        // ğŸš€ åˆæœŸåŒ–
        // =============================================

        window.addEventListener('load', () => {
            init3D();
            game.updateUI();
            
            // åˆæœŸå»ºç‰©ã®é…ç½®
            for (let i = 0; i < 8; i++) {
                const types = ['residential', 'commercial', 'solar', 'park'];
                const type = types[Math.floor(Math.random() * types.length)];
                const pos = game.getRandomGridPosition();
                create3DBuilding(type, pos.x, pos.z);
            }
        });
    </script>
</body>
</html>        }
        .city-view {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 20px;
            position: relative;
            overflow: hidden;
        }
        #city3d {
            width: 100%;
            height: 100%;
        }
        .resource-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin: 20px 0;
        }
        .resource-card {
            background: rgba(255, 255, 255, 0.15);
            padding: 18px;
            border-radius: 15px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        .resource-value {
            font-size: 24px;
            font-weight: bold;
            margin: 8px 0;
        }
        .ai-dashboard {
            background: rgba(255, 215, 0, 0.15);
            border: 2px solid #FFD700;
            border-radius: 15px;
            padding: 20px;
            margin: 25px 0;
        }
        .upgrade-section {
            background: rgba(76, 175, 80, 0.15);
            border-left: 4px solid #4CAF50;
            padding: 18px;
            margin: 15px 0;
            border-radius: 0 12px 12px 0;
        }
        .building-card {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid transparent;
            border-radius: 15px;
            padding: 20px;
            margin: 12px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .building-card:hover {
            border-color: #4FC3F7;
            background: rgba(79, 195, 247, 0.15);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(79, 195, 247, 0.3);
        }
        .control-button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 12px;
            cursor: pointer;
            margin: 8px 0;
            width: 100%;
            font-weight: bold;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        .control-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        .chart-container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 15px;
            margin: 15px 0;
            height: 200px;
        }
        .floating-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            z-index: 1000;
            animation: slideInRight 0.5s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .construction-animation {
            position: absolute;
            width: 80px;
            height: 80px;
            background: radial-gradient(circle, #FFD700 20%, transparent 70%);
            border-radius: 50%;
            pointer-events: none;
            z-index: 100;
            animation: constructPulse 1.5s ease-out;
        }
        @keyframes constructPulse {
            0% { transform: scale(0.8); opacity: 1; }
            100% { transform: scale(2.5); opacity: 0; }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- å·¦ãƒ‘ãƒãƒ«: éƒ½å¸‚çµ±è¨ˆã¨AIåˆ†æ -->
        <div class="panel">
            <h2 style="text-align: center; margin-bottom: 25px; color: #FFD700;">ğŸ™ï¸ AIã‚¹ãƒãƒ¼ãƒˆã‚·ãƒ†ã‚£</h2>
            
            <div class="resource-grid">
                <div class="resource-card">
                    <div>ğŸ’° äºˆç®—</div>
                    <div class="resource-value" id="budget">2,500,000</div>
                    <div>å††</div>
                </div>
                <div class="resource-card">
                    <div>âš¡ ã‚¨ãƒãƒ«ã‚®ãƒ¼</div>
                    <div class="resource-value" id="energy">78%</div>
                    <div>éœ€çµ¦ãƒãƒ©ãƒ³ã‚¹</div>
                </div>
                <div class="resource-card">
                    <div>ğŸŒ¿ ç’°å¢ƒ</div>
                    <div class="resource-value" id="environment">82%</div>
                    <div>æŒç¶šå¯èƒ½æ€§</div>
                </div>
                <div class="resource-card">
                    <div>ğŸ‘¥ äººå£</div>
                    <div class="resource-value" id="population">75,000</div>
                    <div>ä½æ°‘æ•°</div>
                </div>
            </div>

            <div class="ai-dashboard">
                <h3 style="color: #FFD700; margin-bottom: 15px;">ğŸ¤– AIåˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h3>
                <div id="aiSuggestion" style="margin: 12px 0; font-size: 14px; line-height: 1.4;">
                    ğŸ” åˆ†æä¸­...
                </div>
                <div id="prediction" style="font-size: 13px; opacity: 0.9; margin: 8px 0;">
                    ğŸ“ˆ äºˆæ¸¬: è¨ˆç®—ä¸­...
                </div>
                <div class="chart-container">
                    <canvas id="resourceChart"></canvas>
                </div>
            </div>

            <div class="upgrade-section">
                <h4 style="color: #4CAF50; margin-bottom: 12px;">ğŸ“ ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰æ¨å¥¨é ˜åŸŸ</h4>
                <div style="font-size: 13px; line-height: 1.5;">
                    <strong>æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—:</strong><br>
                    â€¢ TensorFlow.jsã§æœ¬ç‰©ã®LSTMäºˆæ¸¬ãƒ¢ãƒ‡ãƒ«<br>
                    â€¢ å¼·åŒ–å­¦ç¿’(DQN)ã®å®Ÿè£…<br>
                    â€¢ éºä¼çš„ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«ã‚ˆã‚‹æœ€é©åŒ–<br>
                    â€¢ å¤–éƒ¨APIé€£æºï¼ˆå¤©æ°—ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¾¡æ ¼ï¼‰
                </div>
            </div>
        </div>

        <!-- ä¸­å¤®: 3Déƒ½å¸‚ãƒ“ãƒ¥ãƒ¼ -->
        <div class="city-view">
            <div id="city3d"></div>
            <div id="constructionEffects"></div>
        </div>

        <!-- å³ãƒ‘ãƒãƒ«: å»ºè¨­ã¨åˆ¶å¾¡ -->
        <div class="panel">
            <h2 style="color: #FFD700; margin-bottom: 20px;">ğŸ—ï¸ ã‚¹ãƒãƒ¼ãƒˆå»ºè¨­</h2>
            
            <div style="margin: 20px 0;">
                <div style="font-size: 16px; margin-bottom: 10px;">ã‚¿ãƒ¼ãƒ³: <span id="turn">1</span></div>
                <button class="control-button" onclick="nextTurn()">â­ï¸ æ¬¡ã®ã‚¿ãƒ¼ãƒ³ã‚’å®Ÿè¡Œ</button>
                <button class="control-button" onclick="runAdvancedAI()" style="background: linear-gradient(135deg, #FFD700, #FF9800);">
                    ğŸ§  é«˜åº¦AIåˆ†æå®Ÿè¡Œ
                </button>
            </div>

            <!-- å»ºè¨­ã‚ªãƒ—ã‚·ãƒ§ãƒ³ -->
            <div class="building-card" onclick="constructBuilding('solar_farm')">
                <div style="display: flex; align-items: center; gap: 15px;">
                    <span style="font-size: 32px;">â˜€ï¸</span>
                    <div style="flex: 1;">
                        <div style="font-weight: bold; font-size: 16px;">ãƒ¡ã‚¬ã‚½ãƒ¼ãƒ©ãƒ¼ãƒ‘ãƒ¼ã‚¯</div>
                        <div style="font-size: 13px; opacity: 0.8; margin-top: 4px;">AIåˆ¶å¾¡ã®å¤ªé™½å…‰ç™ºé›»æ–½è¨­</div>
                    </div>
                </div>
                <div style="margin-top: 12px; display: flex; gap: 10px; flex-wrap: wrap;">
                    <span style="background: rgba(76, 175, 80, 0.3); padding: 4px 8px; border-radius: 8px; font-size: 12px;">ç’°å¢ƒ+25%</span>
                    <span style="background: rgba(255, 193, 7, 0.3); padding: 4px 8px; border-radius: 8px; font-size: 12px;">ã‚¨ãƒãƒ«ã‚®ãƒ¼+30%</span>
                </div>
                <div style="text-align: right; margin-top: 10px; color: #FFD700; font-weight: bold;">ğŸ’° 500,000</div>
            </div>

            <div class="building-card" onclick="constructBuilding('wind_farm')">
                <div style="display: flex; align-items: center; gap: 15px;">
                    <span style="font-size: 32px;">ğŸŒ¬ï¸</span>
                    <div style="flex: 1;">
                        <div style="font-weight: bold; font-size: 16px;">ã‚¹ãƒãƒ¼ãƒˆé¢¨åŠ›ç™ºé›»</div>
                        <div style="font-size: 13px; opacity: 0.8; margin-top: 4px;">AIäºˆæ¸¬ã«ã‚ˆã‚‹åŠ¹ç‡é‹è»¢</div>
                    </div>
                </div>
                <div style="margin-top: 12px; display: flex; gap: 10px; flex-wrap: wrap;">
                    <span style="background: rgba(76, 175, 80, 0.3); padding: 4px 8px; border-radius: 8px; font-size: 12px;">ç’°å¢ƒ+30%</span>
                    <span style="background: rgba(255, 193, 7, 0.3); padding: 4px 8px; border-radius: 8px; font-size: 12px;">ã‚¨ãƒãƒ«ã‚®ãƒ¼+35%</span>
                </div>
                <div style="text-align: right; margin-top: 10px; color: #FFD700; font-weight: bold;">ğŸ’° 750,000</div>
            </div>

            <div class="building-card" onclick="constructBuilding('ai_research')">
                <div style="display: flex; align-items: center; gap: 15px;">
                    <span style="font-size: 32px;">ğŸ”¬</span>
                    <div style="flex: 1;">
                        <div style="font-weight: bold; font-size: 16px;">AIç ”ç©¶æ‰€</div>
                        <div style="font-size: 13px; opacity: 0.8; margin-top: 4px;">æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«é–‹ç™ºæ–½è¨­</div>
                    </div>
                </div>
                <div style="margin-top: 12px; display: flex; gap: 10px; flex-wrap: wrap;">
                    <span style="background: rgba(156, 39, 176, 0.3); padding: 4px 8px; border-radius: 8px; font-size: 12px;">AIç²¾åº¦+40%</span>
                    <span style="background: rgba(33, 150, 243, 0.3); padding: 4px 8px; border-radius: 8px; font-size: 12px;">ç ”ç©¶é€Ÿåº¦+25%</span>
                </div>
                <div style="text-align: right; margin-top: 10px; color: #FFD700; font-weight: bold;">ğŸ’° 1,200,000</div>
            </div>

            <div class="upgrade-section">
                <h4 style="color: #4CAF50; margin-bottom: 12px;">ğŸ”§ é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«</h4>
                <button class="control-button" onclick="trainMLModel()" style="background: linear-gradient(135deg, #9C27B0, #673AB7);">
                    ğŸ¤– æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«å†è¨“ç·´
                </button>
                <button class="control-button" onclick="exportCityData()" style="background: linear-gradient(135deg, #FF9800, #F57C00);">
                    ğŸ“Š éƒ½å¸‚ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
                </button>
            </div>
        </div>
    </div>

    <script>
        // =============================================
        // ğŸ® ã‚²ãƒ¼ãƒ ã‚¨ãƒ³ã‚¸ãƒ³ - å®Œå…¨å®Ÿè£…
        // =============================================

        class SmartCityGame {
            constructor() {
                this.resources = {
                    budget: 2500000,
                    energy: 78,
                    environment: 82,
                    population: 75000,
                    turn: 1,
                    aiEfficiency: 50
                };
                this.buildings = [];
                this.history = [];
                this.aiSystem = new AdvancedAISystem();
                this.chart = null;
                this.initChart();
            }

            async constructBuilding(type) {
                const cost = this.getBuildingCost(type);
                if (this.resources.budget < cost) {
                    this.showNotification('âŒ äºˆç®—ãŒè¶³ã‚Šã¾ã›ã‚“');
                    return false;
                }

                // å»ºè¨­ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
                this.showConstructionEffect();

                this.resources.budget -= cost;
                this.applyBuildingEffects(type);
                this.buildings.push({ 
                    type, 
                    turn: this.resources.turn,
                    position: this.getRandomPosition()
                });

                // AIã‚·ã‚¹ãƒ†ãƒ æ›´æ–°
                await this.aiSystem.update(this.resources, this.buildings);
                
                this.showNotification(`âœ… ${this.getBuildingName(type)}ã‚’å»ºè¨­ã—ã¾ã—ãŸ`);
                this.updateUI();
                return true;
            }

            getBuildingCost(type) {
                const costs = {
                    'solar_farm': 500000,
                    'wind_farm': 750000,
                    'ai_research': 1200000
                };
                return costs[type] || 0;
            }

            getBuildingName(type) {
                const names = {
                    'solar_farm': 'ãƒ¡ã‚¬ã‚½ãƒ¼ãƒ©ãƒ¼ãƒ‘ãƒ¼ã‚¯',
                    'wind_farm': 'ã‚¹ãƒãƒ¼ãƒˆé¢¨åŠ›ç™ºé›»',
                    'ai_research': 'AIç ”ç©¶æ‰€'
                };
                return names[type] || type;
            }

            applyBuildingEffects(type) {
                const effects = {
                    'solar_farm': { energy: 30, environment: 25 },
                    'wind_farm': { energy: 35, environment: 30 },
                    'ai_research': { aiEfficiency: 40 }
                };

                const effect = effects[type] || {};
                Object.keys(effect).forEach(key => {
                    this.resources[key] = Math.min(100, this.resources[key] + effect[key]);
                });
            }

            getRandomPosition() {
                return {
                    x: (Math.random() - 0.5) * 35,
                    z: (Math.random() - 0.5) * 35
                };
            }

            async nextTurn() {
                this.resources.turn++;
                
                // ã‚¿ãƒ¼ãƒ³ã”ã¨ã®è‡ªç„¶ãªå¤‰åŒ–
                this.resources.energy = Math.max(0, this.resources.energy - 8);
                this.resources.population += Math.floor(this.resources.population * 0.03);
                this.resources.budget += Math.floor(this.resources.population * 2.5); // ç¨å
                
                // AIäºˆæ¸¬ã®æ›´æ–°
                await this.aiSystem.update(this.resources, this.buildings);
                
                this.history.push({...this.resources});
                this.updateChart();
                this.showNotification(`ğŸ“Š ã‚¿ãƒ¼ãƒ³ ${this.resources.turn} é–‹å§‹ - ç¨å: ${Math.floor(this.resources.population * 2.5).toLocaleString()}å††`);
                this.updateUI();
            }

            showConstructionEffect() {
                const effectsContainer = document.getElementById('constructionEffects');
                const effect = document.createElement('div');
                effect.className = 'construction-animation';
                effect.style.left = '50%';
                effect.style.top = '50%';
                effectsContainer.appendChild(effect);
                
                setTimeout(() => effect.remove(), 1500);
            }

            showNotification(message) {
                const notification = document.createElement('div');
                notification.className = 'floating-notification';
                notification.textContent = message;
                document.body.appendChild(notification);
                
                setTimeout(() => notification.remove(), 4000);
            }

            initChart() {
                const ctx = document.getElementById('resourceChart').getContext('2d');
                this.chart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['T-2', 'T-1', 'ç¾åœ¨'],
                        datasets: [
                            {
                                label: 'ã‚¨ãƒãƒ«ã‚®ãƒ¼',
                                data: [75, 78, 78],
                                borderColor: '#4FC3F7',
                                backgroundColor: 'rgba(79, 195, 247, 0.1)',
                                tension: 0.4
                            },
                            {
                                label: 'ç’°å¢ƒ',
                                data: [80, 82, 82],
                                borderColor: '#4CAF50',
                                backgroundColor: 'rgba(76, 175, 80, 0.1)',
                                tension: 0.4
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: { color: 'white' }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: false,
                                min: 50,
                                max: 100,
                                grid: { color: 'rgba(255,255,255,0.1)' },
                                ticks: { color: 'white' }
                            },
                            x: {
                                grid: { color: 'rgba(255,255,255,0.1)' },
                                ticks: { color: 'white' }
                            }
                        }
                    }
                });
            }

            updateChart() {
                if (this.history.length >= 3) {
                    const recent = this.history.slice(-3);
                    this.chart.data.labels = recent.map((_, i) => `T-${2-i}`).concat(['ç¾åœ¨']);
                    this.chart.data.datasets[0].data = recent.map(h => h.energy).concat([this.resources.energy]);
                    this.chart.data.datasets[1].data = recent.map(h => h.environment).concat([this.resources.environment]);
                    this.chart.update();
                }
            }

            updateUI() {
                document.getElementById('budget').textContent = this.resources.budget.toLocaleString();
                document.getElementById('energy').textContent = this.resources.energy + '%';
                document.getElementById('environment').textContent = this.resources.environment + '%';
                document.getElementById('population').textContent = this.resources.population.toLocaleString();
                document.getElementById('turn').textContent = this.resources.turn;
                
                // AIææ¡ˆã®è¡¨ç¤º
                document.getElementById('aiSuggestion').innerHTML = this.aiSystem.getSuggestion();
                document.getElementById('prediction').textContent = this.aiSystem.getPrediction();
            }
        }

        // =============================================
        // ğŸ¤– é«˜åº¦AIã‚·ã‚¹ãƒ†ãƒ  - TensorFlow.jsçµ±åˆ
        // =============================================

        class AdvancedAISystem {
            constructor() {
                this.predictionModel = null;
                this.isTraining = false;
                this.initModel();
            }

            async initModel() {
                // ã‚·ãƒ³ãƒ—ãƒ«ãªç·šå½¢å›å¸°ãƒ¢ãƒ‡ãƒ«
                this.predictionModel = tf.sequential({
                    layers: [
                        tf.layers.dense({ inputShape: [4], units: 8, activation: 'relu' }),
                        tf.layers.dense({ units: 4, activation: 'relu' }),
                        tf.layers.dense({ units: 2, activation: 'linear' })
                    ]
                });

                this.predictionModel.compile({
                    optimizer: 'adam',
                    loss: 'meanSquaredError'
                });
            }

            async update(resources, buildings) {
                // ãƒªã‚½ãƒ¼ã‚¹çŠ¶æ…‹ã«åŸºã¥ã„ãŸAIææ¡ˆã‚’ç”Ÿæˆ
                await this.generateSuggestions(resources, buildings);
            }

            async generateSuggestions(resources, buildings) {
                // ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹AI
                this.suggestion = this.ruleBasedSuggestion(resources);
                this.prediction = this.ruleBasedPrediction(resources);
            }

            ruleBasedSuggestion(resources) {
                if (resources.energy < 60) {
                    return "âš ï¸ ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¸è¶³: å†ç”Ÿå¯èƒ½ã‚¨ãƒãƒ«ã‚®ãƒ¼æ–½è¨­ã®å»ºè¨­ã‚’æ¨å¥¨";
                } else if (resources.environment < 70) {
                    return "ğŸŒ¿ ç’°å¢ƒæŒ‡æ¨™ä½ä¸‹: ç’°å¢ƒä¿è­·æ–½è¨­ã®å„ªå…ˆå»ºè¨­ã‚’æ¨å¥¨";
                } else if (resources.budget > 2000000) {
                    return "ğŸ’¡ äºˆç®—ä½™è£•: AIç ”ç©¶æ‰€ã§æŠ€è¡“é©æ–°ã‚’";
                } else {
                    return "âœ… ãƒãƒ©ãƒ³ã‚¹è‰¯å¥½: æŒç¶šå¯èƒ½ãªé–‹ç™ºã‚’ç¶™ç¶š";
                }
            }

            ruleBasedPrediction(resources) {
                const energyTrend = resources.energy < 65 ? "æ€¥ä¸Šæ˜‡" : "ç·©ã‚„ã‹ä¸Šæ˜‡";
                const nextEnergy = Math.min(100, resources.energy + (resources.energy < 60 ? 15 : 8));
                return `ã‚¨ãƒãƒ«ã‚®ãƒ¼: ${nextEnergy}% (${energyTrend}) - 3ã‚¿ãƒ¼ãƒ³å¾Œ`;
            }

            getSuggestion() {
                const icon = this.suggestion.includes('âš ï¸') ? 'âš ï¸' : 
                            this.suggestion.includes('ğŸŒ¿') ? 'ğŸŒ¿' : 
                            this.suggestion.includes('ğŸ’¡') ? 'ğŸ’¡' : 'âœ…';
                return `${icon} ${this.suggestion}`;
            }

            getPrediction() {
                return `ğŸ“ˆ ${this.prediction}`;
            }

            // ğŸ“ ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ç”¨ãƒ¡ã‚½ãƒƒãƒ‰
            async trainAdvancedModel(trainingData) {
                // TODO: ã‚ãªãŸãŒå®Ÿè£… - LSTMã‚„ã‚ˆã‚Šè¤‡é›‘ãªãƒ¢ãƒ‡ãƒ«
                console.log('é«˜åº¦ãªãƒ¢ãƒ‡ãƒ«ã®è¨“ç·´ã‚’é–‹å§‹...');
            }

            async predictWithAdvancedModel(inputData) {
                // TODO: ã‚ãªãŸãŒå®Ÿè£… - ã‚ˆã‚Šæ­£ç¢ºãªäºˆæ¸¬
                return "é«˜åº¦ãªäºˆæ¸¬ãƒ¢ãƒ‡ãƒ«å®Ÿè£…å¾…ã¡";
            }
        }

        // =============================================
        // ğŸ® 3Déƒ½å¸‚ã‚¨ãƒ³ã‚¸ãƒ³
        // =============================================

        let scene, camera, renderer, controls;
        const game = new SmartCityGame();

        function init3D() {
            // ã‚·ãƒ¼ãƒ³è¨­å®š
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x1a2a6c);
            scene.fog = new THREE.Fog(0x1a2a6c, 10, 50);
            
            // ã‚«ãƒ¡ãƒ©è¨­å®š
            const container = document.getElementById('city3d');
            camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
            camera.position.set(25, 20, 25);
            camera.lookAt(0, 0, 0);
            
            // ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼è¨­å®š
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(container.clientWidth, container.clientHeight);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            container.appendChild(renderer.domElement);
            
            // ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«è¨­å®š
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            
            // é«˜åº¦ãªãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚°
            setupAdvancedLighting();
            
            // ç’°å¢ƒæ§‹ç¯‰
            createAdvancedEnvironment();
            
            // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ—
            function animate() {
                requestAnimationFrame(animate);
                controls.update();
                renderer.render(scene, camera);
            }
            animate();
            
            window.addEventListener('resize', onWindowResize);
        }

        function setupAdvancedLighting() {
            const ambientLight = new THREE.AmbientLight(0x404040, 0.5);
            scene.add(ambientLight);
            
            const mainLight = new THREE.DirectionalLight(0xffffff, 1);
            mainLight.position.set(15, 25, 10);
            mainLight.castShadow = true;
            mainLight.shadow.mapSize.width = 2048;
            mainLight.shadow.mapSize.height = 2048;
            scene.add(mainLight);
            
            const fillLight = new THREE.DirectionalLight(0x667eea, 0.3);
            fillLight.position.set(-10, 15, -5);
            scene.add(fillLight);
        }

        function createAdvancedEnvironment() {
            // ãƒ†ã‚¯ã‚¹ãƒãƒ£é¢¨ã®åœ°é¢
            const groundGeometry = new THREE.PlaneGeometry(80, 80, 20, 20);
            const groundMaterial = new THREE.MeshLambertMaterial({ 
                color: 0x2d5a27,
                side: THREE.DoubleSide 
            });
            const ground = new THREE.Mesh(groundGeometry, groundMaterial);
            ground.rotation.x = -Math.PI / 2;
            ground.receiveShadow = true;
            scene.add(ground);
            
            // è©³ç´°ãªé“è·¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯
            createDetailedRoadSystem();
            
            // åˆæœŸå»ºç‰©
            createInitialBuildings();
        }

        function createDetailedRoadSystem() {
            const roadMaterial = new THREE.MeshLambertMaterial({ color: 0x333333 });
            
            for (let i = -30; i <= 30; i += 15) {
                const roadGeometry = new THREE.PlaneGeometry(80, 4);
                const road1 = new THREE.Mesh(roadGeometry, roadMaterial);
                road1.rotation.x = -Math.PI / 2;
                road1.position.set(0, 0.02, i);
                road1.receiveShadow = true;
                
                const road2 = new THREE.Mesh(roadGeometry, roadMaterial);
                road2.rotation.x = -Math.PI / 2;
                road2.rotation.z = Math.PI / 2;
                road2.position.set(i, 0.02, 0);
                road2.receiveShadow = true;
                
                scene.add(road1);
                scene.add(road2);
            }
        }

        function createInitialBuildings() {
            // åˆæœŸéƒ½å¸‚ã®å»ºç‰©
            for (let i = 0; i < 6; i++) {
                const type = i % 2 === 0 ? 'solar_farm' : 'wind_farm';
                const pos = game.getRandomPosition();
                create3DBuilding(type, pos.x, pos.z);
            }
        }

        function create3DBuilding(type, x, z) {
            let geometry, material, color, height;
            
            switch(type) {
                case 'solar_farm':
                    geometry = new THREE.BoxGeometry(4, 0.3, 4);
                    color = 0xf9ca24;
                    height = 0.15;
                    break;
                case 'wind_farm':
                    geometry = new THREE.CylinderGeometry(0.8, 1, 4, 6);
                    color = 0x74b9ff;
                    height = 2;
                    break;
                case 'ai_research':
                    geometry = new THREE.BoxGeometry(3, 2, 3);
                    color = 0x9C27B0;
                    height = 1;
                    break;
            }
            
            material = new THREE.MeshLambertMaterial({ 
                color,
                roughness: 0.7,
                metalness: 0.1
            });
            const building = new THREE.Mesh(geometry, material);
            building.position.set(x, height, z);
            building.castShadow = true;
            building.receiveShadow = true;
            
            scene.add(building);
            return building;
        }

        // =============================================
        // ğŸ® ã‚²ãƒ¼ãƒ åˆ¶å¾¡é–¢æ•°
        // =============================================

        async function constructBuilding(type) {
            const success = await game.constructBuilding(type);
            if (success) {
                const building = game.buildings[game.buildings.length - 1];
                create3DBuilding(type, building.position.x, building.position.z);
            }
        }

        async function nextTurn() {
            await game.nextTurn();
        }

        async function runAdvancedAI() {
            game.showNotification('ğŸ§  é«˜åº¦AIåˆ†æã‚’å®Ÿè¡Œä¸­...');
            // æ¨¡æ“¬å‡¦ç†
            setTimeout(() => {
                game.showNotification('âœ… AIåˆ†æå®Œäº†: æœ€é©åŒ–ææ¡ˆã‚’æ›´æ–°ã—ã¾ã—ãŸ');
            }, 2000);
        }

        async function trainMLModel() {
            game.showNotification('ğŸ¤– æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã‚’è¨“ç·´ä¸­...');
            // TODO: ã‚ãªãŸãŒå®Ÿè£… - å®Ÿéš›ã®ãƒ¢ãƒ‡ãƒ«è¨“ç·´
            setTimeout(() => {
                game.showNotification('âœ… ãƒ¢ãƒ‡ãƒ«è¨“ç·´å®Œäº† - ç²¾åº¦å‘ä¸Šã—ã¾ã—ãŸ');
            }, 3000);
        }

        function exportCityData() {
            const data = {
                resources: game.resources,
                buildings: game.buildings,
                history: game.history
            };
            const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `smart_city_data_turn_${game.resources.turn}.json`;
            a.click();
            game.showNotification('ğŸ“Š éƒ½å¸‚ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ');
        }

        function onWindowResize() {
            const container = document.getElementById('city3d');
            camera.aspect = container.clientWidth / container.clientHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(container.clientWidth, container.clientHeight);
        }

        // =============================================
        // ğŸš€ åˆæœŸåŒ–
        // =============================================

        window.addEventListener('load', async () => {
            init3D();
            game.updateUI();
            
            // TensorFlow.jsã®æº–å‚™
            await tf.ready();
            game.showNotification('ğŸ¤– AIã‚·ã‚¹ãƒ†ãƒ : TensorFlow.js æº–å‚™å®Œäº†');
        });
    </script>
</body>
</html>
