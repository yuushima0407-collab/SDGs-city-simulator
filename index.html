<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SDGs City Manager Ver4 - æ•™è‚²ç‰ˆ</title>
<style>
body{font-family:Arial,sans-serif;margin:0;padding:0;background:#e0f7fa;color:#222;}
h1,h2{margin:10px 0;}
.hidden{display:none;}
#city-img{width:90%;max-width:600px;margin:20px auto;display:block;border-radius:8px;transition:0.5s;}
button{margin:10px;padding:12px 20px;font-size:16px;border:none;border-radius:5px;background:#0288d1;color:white;cursor:pointer;}
button:hover{background:#0277bd;}
#score-bar{margin:10px auto;width:90%;max-width:600px;text-align:left;}
.score-gauge{height:20px;background:#ccc;border-radius:10px;margin:5px 0;position:relative;}
.score-fill{height:100%;border-radius:10px;transition:0.5s;}
#choices button{display:block;width:80%;margin:10px auto;}
#explanation{background:#fff3e0;padding:10px;margin:10px auto;border-radius:8px;max-width:600px;display:none;}
</style>
</head>
<body>
<div id="app">
  <!-- ã‚¿ã‚¤ãƒˆãƒ« -->
  <div id="title-screen">
    <h1>SDGs City Manager</h1>
    <p>éƒ½å¸‚èª²é¡Œã‚’è§£æ±ºã—ãªãŒã‚‰ã€SDGsã‚’æ¥½ã—ãå­¦ã¶ã‚²ãƒ¼ãƒ </p>
    <button id="start-btn">ã‚²ãƒ¼ãƒ é–‹å§‹</button>
  </div>

  <!-- å•é¡Œç”»é¢ -->
  <div id="question-screen" class="hidden">
    <h2 id="city-name"></h2>
    <img id="city-img" src="" alt="éƒ½å¸‚ç”»åƒ">
    <h2 id="question-text"></h2>
    <div id="choices"></div>
    <div id="score-bar">
      <div>ğŸŒ¿ç’°å¢ƒ
        <div class="score-gauge"><div id="env-fill" class="score-fill" style="width:0%;background:green;"></div></div>
      </div>
      <div>ğŸ’°çµŒæ¸ˆ
        <div class="score-gauge"><div id="eco-fill" class="score-fill" style="width:0%;background:gold;"></div></div>
      </div>
      <div>ğŸ¤ç¤¾ä¼š
        <div class="score-gauge"><div id="soc-fill" class="score-fill" style="width:0%;background:blue;"></div></div>
      </div>
    </div>
    <div id="explanation"></div>
  </div>

  <!-- çµæœç”»é¢ -->
  <div id="result-screen" class="hidden">
    <h2>ã‚²ãƒ¼ãƒ çµæœ</h2>
    <p id="result-text"></p>
    <button id="restart-btn">æœ€åˆã«æˆ»ã‚‹</button>
  </div>
</div>

<!-- ãƒ‡ãƒ¼ã‚¿ -->
<script id="city-data" type="application/json">
[
  {
    "city_id":"tokyo_future",
    "name":"æ±äº¬ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼ãƒ»ãƒ¡ãƒˆãƒ­",
    "level_images":["images/tokyo_future_lv1.jpg","images/tokyo_future_lv2.jpg","images/tokyo_future_lv3.jpg"],
    "questions":[
      {"q":"é›‡ç”¨æ ¼å·®ãŒæ‹¡å¤§ã—ã¦ã„ã‚‹ã€‚ã©ã†ã™ã‚‹ï¼Ÿ",
       "choices":[
         {"text":"AIæ•™è‚²ã‚’å…¨å›½ç„¡æ–™åŒ–","effect":{"social":2},"explanation":"ä¸–ç•Œã®AIæ•™è‚²å°å…¥äº‹ä¾‹ã§ã¯å­¦ç¿’æ ¼å·®æ”¹å–„ã«æˆåŠŸã—ãŸã‚±ãƒ¼ã‚¹ãŒã‚ã‚Šã¾ã™ã€‚"},
         {"text":"å¤–è³‡ç³»ä¼æ¥­ã®èª˜è‡´","effect":{"economy":2},"explanation":"çµŒæ¸ˆã¯ä¼¸ã³ã‚‹ãŒã€æ ¼å·®ã¯åºƒãŒã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚"},
         {"text":"ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ã‚¤ãƒ³ã‚«ãƒ å°å…¥","effect":{"social":1,"economy":-1},"explanation":"ç¤¾ä¼šå®‰å®šã‚’æ”¹å–„ã™ã‚‹ãŒã€è²¡æ”¿è² æ‹…ãŒå¢—ãˆã¾ã™ã€‚"}
       ]
      },
      {"q":"éƒ½å¸‚ç†±å•é¡Œã¸ã®å¯¾ç­–ã¯ï¼Ÿ",
       "choices":[
         {"text":"éƒ½å¸‚ç·‘åŒ–ï¼ˆå‚ç›´åº­åœ’ï¼‰","effect":{"environment":3},"explanation":"ç·‘åŒ–ã§ãƒ’ãƒ¼ãƒˆã‚¢ã‚¤ãƒ©ãƒ³ãƒ‰ã‚’ç·©å’Œã™ã‚‹å®Ÿä¾‹ãŒã‚ã‚Šã¾ã™ã€‚"},
         {"text":"å†·æˆ¿åŠ¹ç‡æ”¹å–„","effect":{"economy":1},"explanation":"çµŒæ¸ˆçš„ã«ã¯åŠ¹ç‡å‘ä¸Šã€‚ç’°å¢ƒã¸ã®åŠ¹æœã¯é™å®šçš„ã€‚"},
         {"text":"æ—¥å°„åå°„èˆ—è£…","effect":{"environment":2},"explanation":"é“è·¯æ¸©åº¦ã‚’ä¸‹ã’ã‚‹æ–¹æ³•ã§ã™ãŒå°å…¥ã‚³ã‚¹ãƒˆã¯é«˜ã‚ã§ã™ã€‚"}
       ]
      },
      {"q":"ã‚¨ãƒãƒ«ã‚®ãƒ¼é›†ä¸­ãƒªã‚¹ã‚¯ã«å¯¾ã—ã¦ï¼Ÿ",
       "choices":[
         {"text":"åœ°æ–¹åˆ†æ•£é›»æº","effect":{"environment":2,"economy":-1},"explanation":"åœé›»ãƒªã‚¹ã‚¯è»½æ¸›ã€‚åˆæœŸã‚³ã‚¹ãƒˆã¯é«˜ã„ã€‚"},
         {"text":"AIæœ€é©åˆ¶å¾¡","effect":{"economy":2,"environment":1},"explanation":"åŠ¹ç‡çš„é‹ç”¨ã§å†ã‚¨ãƒæ´»ç”¨ã‚‚å¢—ãˆã‚‹ä¾‹ãŒã‚ã‚Šã¾ã™ã€‚"},
         {"text":"å†ã‚¨ãƒæŠ•è³‡ãƒ•ã‚¡ãƒ³ãƒ‰è¨­ç«‹","effect":{"economy":1,"social":1},"explanation":"è³‡é‡‘å¾ªç’°ã«ã‚ˆã‚Šé•·æœŸçš„ãªç’°å¢ƒæ”¹å–„ã«å¯„ä¸ã€‚"}
       ]
      }
    ]
  }
]
</script>

<script>
document.addEventListener('DOMContentLoaded',()=>{

const cities = JSON.parse(document.getElementById('city-data').textContent);
let currentCityIndex=0,currentQuestionIndex=0,scores={environment:0,economy:0,social:0};

const titleScreen=document.getElementById('title-screen');
const questionScreen=document.getElementById('question-screen');
const resultScreen=document.getElementById('result-screen');
const startBtn=document.getElementById('start-btn');
const restartBtn=document.getElementById('restart-btn');
const cityImg=document.getElementById('city-img');
const cityName=document.getElementById('city-name');
const questionText=document.getElementById('question-text');
const choicesDiv=document.getElementById('choices');
const envFill=document.getElementById('env-fill');
const ecoFill=document.getElementById('eco-fill');
const socFill=document.getElementById('soc-fill');
const explanationDiv=document.getElementById('explanation');
const resultText=document.getElementById('result-text');

startBtn.onclick=()=>{titleScreen.classList.add('hidden');questionScreen.classList.remove('hidden');showQuestion();};
restartBtn.onclick=()=>location.reload();

function showQuestion(){
  const city=cities[currentCityIndex];
  const question=city.questions[currentQuestionIndex];
  const level=Math.min(Math.floor(currentQuestionIndex/1),city.level_images.length-1);
  fadeImage(city.level_images[level]);
  cityName.textContent=city.name + " (Lv"+(level+1)+")";
  questionText.textContent=question.q;
  explanationDiv.style.display='none';
  choicesDiv.innerHTML='';
  question.choices.forEach(choice=>{
    const btn=document.createElement('button');
    btn.textContent=choice.text;
    btn.onclick=()=>selectChoice(choice);
    choicesDiv.appendChild(btn);
  });
  updateScores();
}

function fadeImage(src){
  cityImg.style.opacity=0;
  setTimeout(()=>{cityImg.src=src;cityImg.style.opacity=1;},300);
}

function selectChoice(choice){
  scores.environment+=(choice.effect.environment||0);
  scores.economy+=(choice.effect.economy||0);
  scores.social+=(choice.effect.social||0);
  explanationDiv.textContent=choice.explanation||'';
  explanationDiv.style.display='block';
  updateScores();
  setTimeout(()=>{
    currentQuestionIndex++;
    if(currentQuestionIndex>=cities[currentCityIndex].questions.length){
      currentCityIndex++;
      currentQuestionIndex=0;
      if(currentCityIndex>=cities.length){showResult();return;}
    }
    showQuestion();
  },2000); // 2ç§’ã§æ¬¡ã®å•é¡Œ
}

function updateScores(){
  envFill.style.width=Math.max(0,scores.environment*10)+'%';
  ecoFill.style.width=Math.max(0,scores.economy*10)+'%';
  socFill.style.width=Math.max(0,scores.social*10)+'%';
}

function showResult(){
  questionScreen.classList.add('hidden');
  resultScreen.classList.remove('hidden');
  const total=(scores.environment+scores.economy+scores.social)/3;
  let type="";
  if(scores.environment>=scores.economy && scores.environment>=scores.social) type="ã‚¨ã‚³é‡è¦–éƒ½å¸‚";
  else if(scores.economy>=scores.environment && scores.economy>=scores.social) type="çµŒæ¸ˆé‡è¦–éƒ½å¸‚";
  else type="ç¤¾ä¼šé‡è¦–éƒ½å¸‚";
  resultText.textContent=`ğŸŒ¿:${scores.environment} ğŸ’°:${scores.economy} ğŸ¤:${scores.social} â†’ ã‚ãªãŸã®éƒ½å¸‚ã‚¿ã‚¤ãƒ—: ${type}`;
}

});
</script>
</body>
</html>
