<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SDGs World Builder - Multiplayer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }

        .app-container {
            max-width: 1600px;
            margin: 0 auto;
        }

        /* 3D„Éì„É•„Éº„Ç¢„Éº */
        .city-3d-view {
            width: 100%;
            height: 400px;
            background: linear-gradient(45deg, #2d3436, #636e72);
            border-radius: 15px;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
        }

        .building-3d {
            position: absolute;
            bottom: 0;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 5px 5px 0 0;
            transition: all 0.5s ease;
        }

        .building-3d:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 25px rgba(255, 255, 255, 0.3);
        }

        /* „Éû„É´„ÉÅ„Éó„É¨„Ç§„É§„Éº */
        .multiplayer-panel {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #74b9ff;
        }

        .players-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }

        .player-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .player-card.online {
            border: 2px solid #00b894;
        }

        .player-card.offline {
            opacity: 0.6;
        }

        .player-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(45deg, #667eea, #764ba2);
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
        }

        /* ‰ªÆÊÉ≥ÈÄöË≤® */
        .crypto-market {
            background: rgba(253, 203, 110, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #fdcb6e;
        }

        .crypto-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }

        .crypto-coin {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }

        .coin-price {
            font-size: 1.3em;
            font-weight: bold;
            margin: 8px 0;
        }

        .price-up { color: #00b894; }
        .price-down { color: #ff7675; }

        /* AI„Ç¢„Éâ„Éê„Ç§„Ç∂„Éº */
        .ai-advisor {
            background: rgba(116, 185, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #74b9ff;
            position: relative;
        }

        .ai-message {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #74b9ff;
        }

        .ai-typing {
            display: inline-block;
            width: 10px;
            height: 10px;
            background: #74b9ff;
            border-radius: 50%;
            margin-left: 5px;
            animation: typing 1s infinite;
        }

        @keyframes typing {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        /* „É™„Ç¢„É´„Çø„Ç§„É†„Éá„Éº„Çø */
        .live-data {
            background: rgba(0, 184, 148, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #00b894;
        }

        .data-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .data-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .data-value {
            font-size: 1.4em;
            font-weight: bold;
            margin: 5px 0;
        }

        /* ÂèñÂºïÂ∏ÇÂ†¥ */
        .marketplace {
            background: rgba(108, 92, 231, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #6c5ce7;
        }

        .market-items {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }

        .market-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            transition: all 0.3s ease;
        }

        .market-item:hover {
            transform: translateY(-3px);
            background: rgba(255, 255, 255, 0.15);
        }

        .item-price {
            color: #fdcb6e;
            font-weight: bold;
            font-size: 1.2em;
        }

        /* „ÉÅ„É£„ÉÉ„Éà„Ç∑„Çπ„ÉÜ„É† */
        .chat-panel {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            height: 300px;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex-grow: 1;
            overflow-y: auto;
            margin-bottom: 15px;
        }

        .chat-message {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 10px 15px;
            margin: 8px 0;
            max-width: 80%;
        }

        .chat-message.own {
            background: rgba(116, 185, 255, 0.3);
            margin-left: auto;
        }

        .chat-input {
            display: flex;
            gap: 10px;
        }

        .chat-input input {
            flex-grow: 1;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 8px;
            padding: 12px;
            color: white;
        }

        /* ÂçîÂäõ„Éó„É≠„Ç∏„Çß„ÇØ„Éà */
        .coop-projects {
            background: rgba(214, 48, 49, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #d63031;
        }

        .project-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #d63031;
        }

        .project-progress {
            margin: 10px 0;
        }

        /* „É¨„Çπ„Éù„É≥„Ç∑„ÉñË™øÊï¥ */
        @media (max-width: 768px) {
            .players-grid,
            .crypto-grid,
            .data-grid,
            .market-items {
                grid-template-columns: 1fr 1fr;
            }
        }

        /* Êó¢Â≠ò„ÅÆ„Çπ„Çø„Ç§„É´„ÇíÁ∂ôÊâø */
        .screen { display: none; }
        .screen.active { display: block; }
        .header { text-align: center; margin-bottom: 30px; }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; background: linear-gradient(45deg, #00b894, #00cec9); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .nav-tabs { display: flex; gap: 10px; margin: 20px 0; flex-wrap: wrap; }
        .nav-tab { padding: 12px 20px; background: rgba(255,255,255,0.1); border-radius: 10px; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; }
        .nav-tab.active { background: #00b894; border-color: #00cec9; }
        .btn { background: linear-gradient(45deg, #00b894, #00cec9); color: white; border: none; padding: 12px 25px; border-radius: 10px; cursor: pointer; font-weight: bold; transition: all 0.3s ease; margin: 5px; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(0,184,148,0.4); }
        .btn-secondary { background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3); }
        .notification { position: fixed; top: 20px; right: 20px; background: linear-gradient(135deg, #00b894, #00a085); color: white; padding: 15px 25px; border-radius: 10px; z-index: 1000; animation: slideIn 0.5s ease; box-shadow: 0 8px 25px rgba(0,0,0,0.3); }
        @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- „Éû„É´„ÉÅ„Éó„É¨„Ç§„É§„Éº„Éè„Éñ -->
        <div id="multiplayerHub" class="screen active">
            <div class="header">
                <h1>üåê SDGs „Ç∞„É≠„Éº„Éê„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ</h1>
                <p>‰∏ñÁïå‰∏≠„ÅÆ„Éó„É¨„Ç§„É§„Éº„Å®ÂçîÂäõ„Åó„Å¶ÊåÅÁ∂öÂèØËÉΩ„Å™Êú™Êù•„ÇíÂâµ„Çç„ÅÜ</p>
            </div>

            <!-- „É™„Ç¢„É´„Çø„Ç§„É†„Éá„Éº„Çø -->
            <div class="live-data">
                <h3>üìä „Ç∞„É≠„Éº„Éê„É´Áµ±Ë®àÔºà„É™„Ç¢„É´„Çø„Ç§„É†Ôºâ</h3>
                <div class="data-grid">
                    <div class="data-item">
                        <div>üåç „Ç™„É≥„É©„Ç§„É≥„Éó„É¨„Ç§„É§„Éº</div>
                        <div class="data-value" id="onlinePlayers">1,247</div>
                        <div>‰∏ñÁïå‰∏≠„ÅßÊé•Á∂ö‰∏≠</div>
                    </div>
                    <div class="data-item">
                        <div>üèôÔ∏è Âª∫Ë®≠„Åï„Çå„ÅüÈÉΩÂ∏Ç</div>
                        <div class="data-value" id="totalCities">8,956</div>
                        <div>ÊåÅÁ∂öÂèØËÉΩ„Å™ÈÉΩÂ∏Ç</div>
                    </div>
                    <div class="data-item">
                        <div>‚ö° ÁØÄÁ¥Ñ„Åï„Çå„Åü„Ç®„Éç„É´„ÇÆ„Éº</div>
                        <div class="data-value" id="savedEnergy">2.4TWh</div>
                        <div>Áõ∏ÂΩì‰∫éÂéüÂ≠êÂäõÁô∫ÈõªÊâÄ2Âü∫ÂàÜ</div>
                    </div>
                    <div class="data-item">
                        <div>üåø ÂâäÊ∏õ„Åï„Çå„ÅüCO2</div>
                        <div class="data-value" id="reducedCO2">1.8Mt</div>
                        <div>Ëá™ÂãïËªä38‰∏áÂè∞ÂàÜ</div>
                    </div>
                </div>
            </div>

            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px;">
                <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
                <div>
                    <!-- 3DÈÉΩÂ∏Ç„Éì„É•„Éº„Ç¢„Éº -->
                    <div class="city-3d-view" id="city3dView">
                        <!-- 3DÂª∫Áâ©„ÅØJavaScript„ÅßÁîüÊàê -->
                    </div>

                    <!-- ÂçîÂäõ„Éó„É≠„Ç∏„Çß„ÇØ„Éà -->
                    <div class="coop-projects">
                        <h3>ü§ù ÂçîÂäõ„Éó„É≠„Ç∏„Çß„ÇØ„Éà</h3>
                        <div class="project-card">
                            <h4>üåä Â§™Âπ≥Ê¥ã„Åî„Åø„Éô„É´„ÉàÊ∏ÖÊéÉ‰ΩúÊà¶</h4>
                            <div class="project-progress">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span>ÈÄ≤ÊçóÁä∂Ê≥Å</span>
                                    <span>68%</span>
                                </div>
                                <div style="height: 8px; background: rgba(255,255,255,0.2); border-radius: 4px; overflow: hidden;">
                                    <div style="height: 100%; width: 68%; background: #00b894; border-radius: 4px;"></div>
                                </div>
                            </div>
                            <p>ÁõÆÊ®ô: 1,000„Éà„É≥„ÅÆÊµ∑Ê¥ã„Éó„É©„Çπ„ÉÅ„ÉÉ„ÇØÂõûÂèé</p>
                            <div style="display: flex; gap: 10px; margin-top: 10px;">
                                <button class="btn" onclick="joinProject('ocean_cleanup')">ÂèÇÂä†„Åô„Çã</button>
                                <button class="btn btn-secondary" onclick="donateToProject('ocean_cleanup')">üí∞ ÂØÑ‰ªò„Åô„Çã</button>
                            </div>
                        </div>

                        <div class="project-card">
                            <h4>üå≥ „Ç¢„Éû„Çæ„É≥ÂÜçÊ§çÊûó„Éó„É≠„Ç∏„Çß„ÇØ„Éà</h4>
                            <div class="project-progress">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span>ÈÄ≤ÊçóÁä∂Ê≥Å</span>
                                    <span>42%</span>
                                </div>
                                <div style="height: 8px; background: rgba(255,255,255,0.2); border-radius: 4px; overflow: hidden;">
                                    <div style="height: 100%; width: 42%; background: #00b894; border-radius: 4px;"></div>
                                </div>
                            </div>
                            <p>ÁõÆÊ®ô: 100‰∏áÊú¨„ÅÆÊ§çÊ®π</p>
                            <button class="btn" onclick="joinProject('reforestation')">ÂèÇÂä†„Åô„Çã</button>
                        </div>
                    </div>
                </div>

                <!-- „Çµ„Ç§„Éâ„Éê„Éº -->
                <div>
                    <!-- „Ç™„É≥„É©„Ç§„É≥„Éó„É¨„Ç§„É§„Éº -->
                    <div class="multiplayer-panel">
                        <h3>üë• „Ç™„É≥„É©„Ç§„É≥„Éó„É¨„Ç§„É§„Éº</h3>
                        <div class="players-grid" id="playersGrid">
                            <!-- „Éó„É¨„Ç§„É§„Éº„Ç´„Éº„Éâ„ÅØJavaScript„ÅßÁîüÊàê -->
                        </div>
                    </div>

                    <!-- ‰ªÆÊÉ≥ÈÄöË≤®Â∏ÇÂ†¥ -->
                    <div class="crypto-market">
                        <h3>üí∞ SDGs„Éà„Éº„ÇØ„É≥Áõ∏Â†¥</h3>
                        <div class="crypto-grid">
                            <div class="crypto-coin">
                                <div>üåø ECO</div>
                                <div class="coin-price price-up">¬•245.6</div>
                                <div>+2.3%</div>
                            </div>
                            <div class="crypto-coin">
                                <div>üíß WTR</div>
                                <div class="coin-price price-up">¬•187.9</div>
                                <div>+1.8%</div>
                            </div>
                            <div class="crypto-coin">
                                <div>‚ö° NRG</div>
                                <div class="coin-price price-down">¬•312.4</div>
                                <div>-0.7%</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AI„Ç¢„Éâ„Éê„Ç§„Ç∂„Éº -->
            <div class="ai-advisor">
                <h3>ü§ñ AI SDGs„Ç¢„Éâ„Éê„Ç§„Ç∂„Éº</h3>
                <div class="ai-message">
                    <strong>„Ç¢„Éâ„Éê„Ç§„Çπ:</strong> „ÅÇ„Å™„Åü„ÅÆÈÉΩÂ∏Ç„ÅØ„Ç®„Éç„É´„ÇÆ„ÉºÂäπÁéá„ÅåÂÑ™„Çå„Å¶„ÅÑ„Åæ„Åô„Åå„ÄÅÊ∞¥Ë≥áÊ∫êÁÆ°ÁêÜ„Å´ÊîπÂñÑ„ÅÆ‰ΩôÂú∞„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ„Ç∑„É≥„Ç¨„Éù„Éº„É´„ÅÆNEWaterÊäÄË°ì„ÇíÂ∞éÂÖ•„Åó„Å¶„Åø„Å¶„ÅØ„ÅÑ„Åã„Åå„Åß„Åó„Çá„ÅÜ„ÅãÔºü
                </div>
                <div class="ai-message">
                    <strong>Â∏ÇÂ†¥ÂàÜÊûê:</strong> ECO„Éà„Éº„ÇØ„É≥„Åå‰∏äÊòáÂÇæÂêë„Å´„ÅÇ„Çä„Åæ„Åô„ÄÇÁí∞Â¢É„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Å∏„ÅÆÊäïË≥á„ÅåÂ¢óÂä†„Åó„Å¶„ÅÑ„Çã„Åü„ÇÅ„Åß„Åô„ÄÇ
                </div>
                <button class="btn" onclick="askAIAdvice()">üéØ Êñ∞„Åó„ÅÑ„Ç¢„Éâ„Éê„Ç§„Çπ„ÇíÊ±Ç„ÇÅ„Çã</button>
                <span class="ai-typing"></span>
            </div>

            <!-- „ÉÅ„É£„ÉÉ„Éà„Ç∑„Çπ„ÉÜ„É† -->
            <div class="chat-panel">
                <h3>üí¨ „Ç∞„É≠„Éº„Éê„É´„ÉÅ„É£„ÉÉ„Éà</h3>
                <div class="chat-messages" id="chatMessages">
                    <div class="chat-message">
                        <strong>Tokyo_Planter:</strong> Êó•Êú¨„ÅÆÂ±ã‰∏äÁ∑ëÂåñÊäÄË°ì„ÇíÂÖ±Êúâ„Åó„Åæ„ÅôÔºÅ
                    </div>
                    <div class="chat-message">
                        <strong>Berlin_Energy:</strong> „Éâ„Ç§„ÉÑ„ÅÆ„Çπ„Éû„Éº„Éà„Ç∞„É™„ÉÉ„Éâ„Éá„Éº„Çø„ÅåÂøÖË¶Å„Å™Êñπ„ÅØ„ÅÑ„Åæ„Åô„ÅãÔºü
                    </div>
                    <div class="chat-message own">
                        <strong>„ÅÇ„Å™„Åü:</strong> „É´„ÉØ„É≥„ÉÄ„ÅÆ„Åî„ÅøÊîøÁ≠ñ„Å´„Å§„ÅÑ„Å¶Ë©≥„Åó„ÅèÁü•„Çä„Åü„ÅÑ„Åß„Åô
                    </div>
                </div>
                <div class="chat-input">
                    <input type="text" id="chatInput" placeholder="„É°„ÉÉ„Çª„Éº„Ç∏„ÇíÂÖ•Âäõ...">
                    <button class="btn" onclick="sendChatMessage()">ÈÄÅ‰ø°</button>
                </div>
            </div>

            <!-- ÂèñÂºïÂ∏ÇÂ†¥ -->
            <div class="marketplace">
                <h3>üõí SDGsÊäÄË°ìÂ∏ÇÂ†¥</h3>
                <div class="market-items">
                    <div class="market-item">
                        <h4>üáØüáµ Êó•Êú¨„ÅÆÂ§™ÈôΩÂÖâÊäÄË°ì</h4>
                        <p>Â§âÊèõÂäπÁéá23%„ÅÆÊúÄÊñ∞„Éë„Éç„É´</p>
                        <div class="item-price">ECO 1,200</div>
                        <button class="btn" onclick="buyItem('japan_solar')">Ë≥ºÂÖ•</button>
                    </div>
                    <div class="market-item">
                        <h4>üá©üá™ „Éâ„Ç§„ÉÑ„ÅÆÈ¢®Âäõ„Éá„Éº„Çø</h4>
                        <p>10Âπ¥Èñì„ÅÆÈÅãÁî®„Éá„Éº„Çø„Çª„ÉÉ„Éà</p>
                        <div class="item-price">WTR 850</div>
                        <button class="btn" onclick="buyItem('germany_wind')">Ë≥ºÂÖ•</button>
                    </div>
                    <div class="market-item">
                        <h4>üá∏üá¨ „Ç∑„É≥„Ç¨„Éù„Éº„É´Ê∞¥Âá¶ÁêÜ</h4>
                        <p>NEWater„ÅÆË®≠Ë®àÂõ≥</p>
                        <div class="item-price">NRG 2,100</div>
                        <button class="btn" onclick="buyItem('singapore_water')">Ë≥ºÂÖ•</button>
                    </div>
                </div>
            </div>

            <div style="text-align: center; margin-top: 30px;">
                <button class="btn" onclick="showScreen('cardCollection')">üÉè „Ç´„Éº„ÉâÂõ≥Èëë</button>
                <button class="btn btn-secondary" onclick="showScreen('cityBuilder')">üèôÔ∏è ÂçòÁã¨„Éó„É¨„Ç§</button>
                <button class="btn" onclick="createCoopRoom()">üë• ÂçîÂäõ„É´„Éº„É†‰ΩúÊàê</button>
            </div>
        </div>
    </div>

    <script>
        // „Éû„É´„ÉÅ„Éó„É¨„Ç§„É§„Éº„Ç≤„Éº„É†Áä∂ÊÖã
        const multiplayerState = {
            onlinePlayers: [
                { id: 1, name: 'Eco_Warrior', avatar: 'üåç', country: 'üá∫üá∏', level: 42, online: true },
                { id: 2, name: 'Green_Architect', avatar: 'üèóÔ∏è', country: 'üá©üá™', level: 38, online: true },
                { id: 3, name: 'Water_Guardian', avatar: 'üíß', country: 'üá∏üá¨', level: 35, online: true },
                { id: 4, name: 'Solar_Pioneer', avatar: '‚òÄÔ∏è', country: 'üáØüáµ', level: 45, online: false },
                { id: 5, name: 'Forest_Protector', avatar: 'üå≥', country: 'üáßüá∑', level: 31, online: true }
            ],
            chatMessages: [],
            coopProjects: {
                ocean_cleanup: { progress: 68, participants: 1247, goal: 1000 },
                reforestation: { progress: 42, participants: 892, goal: 1000000 }
            },
            cryptoPrices: {
                ECO: { price: 245.6, change: 2.3 },
                WTR: { price: 187.9, change: 1.8 },
                NRG: { price: 312.4, change: -0.7 }
            },
            userTokens: {
                ECO: 5000,
                WTR: 3200,
                NRG: 1800
            }
        };

        // 3DÈÉΩÂ∏Ç„ÅÆÂª∫Áâ©„Éá„Éº„Çø
        const cityBuildings = [
            { type: 'residential', x: 50, width: 80, height: 120, color: '#74b9ff' },
            { type: 'commercial', x: 150, width: 100, height: 180, color: '#a29bfe' },
            { type: 'solar', x: 280, width: 60, height: 40, color: '#fdcb6e' },
            { type: 'park', x: 360, width: 120, height: 30, color: '#00b894' },
            { type: 'recycling', x: 500, width: 90, height: 70, color: '#55efc4' },
            { type: 'research', x: 620, width: 110, height: 150, color: '#ffeaa7' }
        ];

        // ÂàùÊúüÂåñ
        function initializeMultiplayerHub() {
            render3DCity();
            updateOnlinePlayers();
            startRealTimeUpdates();
            simulateLiveData();
        }

        // 3DÈÉΩÂ∏Ç„ÅÆÊèèÁîª
        function render3DCity() {
            const container = document.getElementById('city3dView');
            container.innerHTML = '';

            cityBuildings.forEach(building => {
                const buildingEl = document.createElement('div');
                buildingEl.className = 'building-3d';
                buildingEl.style.left = building.x + 'px';
                buildingEl.style.width = building.width + 'px';
                buildingEl.style.height = building.height + 'px';
                buildingEl.style.background = building.color;
                buildingEl.title = getBuildingName(building.type);
                
                container.appendChild(buildingEl);
            });
        }

        function getBuildingName(type) {
            const names = {
                residential: '‰ΩèÂÆÖÂú∞',
                commercial: 'ÂïÜÊ•≠„Éì„É´',
                solar: 'Â§™ÈôΩÂÖâÁô∫ÈõªÊâÄ',
                park: 'ÈÉΩÂ∏ÇÂÖ¨Âúí',
                recycling: '„É™„Çµ„Ç§„ÇØ„É´ÊñΩË®≠',
                research: 'Áí∞Â¢ÉÁ†îÁ©∂ÊâÄ'
            };
            return names[type] || type;
        }

        // „Ç™„É≥„É©„Ç§„É≥„Éó„É¨„Ç§„É§„ÉºË°®Á§∫
        function updateOnlinePlayers() {
            const container = document.getElementById('playersGrid');
            container.innerHTML = '';

            multiplayerState.onlinePlayers.forEach(player => {
                const playerEl = document.createElement('div');
                playerEl.className = `player-card ${player.online ? 'online' : 'offline'}`;
                playerEl.innerHTML = `
                    <div class="player-avatar">${player.avatar}</div>
                    <div><strong>${player.name}</strong></div>
                    <div>${player.country} Lv.${player.level}</div>
                    <div style="font-size: 0.8em; opacity: 0.7;">
                        ${player.online ? 'üü¢ „Ç™„É≥„É©„Ç§„É≥' : '‚ö´ „Ç™„Éï„É©„Ç§„É≥'}
                    </div>
                `;
                playerEl.onclick = () => viewPlayerProfile(player.id);
                container.appendChild(playerEl);
            });
        }

        // „É™„Ç¢„É´„Çø„Ç§„É†„Éá„Éº„ÇøÊõ¥Êñ∞
        function startRealTimeUpdates() {
            // ‰ªÆÊÉ≥ÈÄöË≤®‰æ°Ê†º„ÅÆÂ§âÂãï
            setInterval(() => {
                Object.keys(multiplayerState.cryptoPrices).forEach(coin => {
                    const change = (Math.random() - 0.5) * 4;
                    multiplayerState.cryptoPrices[coin].change = parseFloat(change.toFixed(1));
                    multiplayerState.cryptoPrices[coin].price = parseFloat(
                        (multiplayerState.cryptoPrices[coin].price * (1 + change/100)).toFixed(1)
                    );
                });
                updateCryptoDisplay();
            }, 10000);

            // „Ç™„É≥„É©„Ç§„É≥„Éó„É¨„Ç§„É§„ÉºÊï∞„ÅÆÂ§âÂãï
            setInterval(() => {
                const change = Math.floor(Math.random() * 21) - 10;
                const current = parseInt(document.getElementById('onlinePlayers').textContent.replace(',', ''));
                document.getElementById('onlinePlayers').textContent = (current + change).toLocaleString();
            }, 15000);
        }

        // „É©„Ç§„Éñ„Éá„Éº„Çø„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥
        function simulateLiveData() {
            setInterval(() => {
                // ÈÉΩÂ∏ÇÊï∞„ÅÆÂ¢óÂä†
                const cities = parseInt(document.getElementById('totalCities').textContent.replace(',', ''));
                document.getElementById('totalCities').textContent = (cities + Math.floor(Math.random() * 3)).toLocaleString();

                // „Ç®„Éç„É´„ÇÆ„ÉºÁØÄÁ¥Ñ
                const energy = parseFloat(document.getElementById('savedEnergy').textContent);
                document.getElementById('savedEnergy').textContent = (energy + Math.random() * 0.1).toFixed(1) + 'TWh';

                // CO2ÂâäÊ∏õ
                const co2 = parseFloat(document.getElementById('reducedCO2').textContent);
                document.getElementById('reducedCO2').textContent = (co2 + Math.random() * 0.05).toFixed(1) + 'Mt';
            }, 8000);
        }

        // ‰ªÆÊÉ≥ÈÄöË≤®Ë°®Á§∫Êõ¥Êñ∞
        function updateCryptoDisplay() {
            document.querySelectorAll('.crypto-coin').forEach((coin, index) => {
                const coins = Object.keys(multiplayerState.cryptoPrices);
                const coinData = multiplayerState.cryptoPrices[coins[index]];
                
                const priceEl = coin.querySelector('.coin-price');
                priceEl.textContent = `¬•${coinData.price}`;
                priceEl.className = `coin-price ${coinData.change >= 0 ? 'price-up' : 'price-down'}`;
                
                const changeEl = coin.querySelector('.coin-price').nextElementSibling;
                changeEl.textContent = `${coinData.change >= 0 ? '+' : ''}${coinData.change}%`;
            });
        }

        // „ÉÅ„É£„ÉÉ„ÉàÊ©üËÉΩ
        function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (message) {
                const chatMessages = document.getElementById('chatMessages');
                const messageEl = document.createElement('div');
                messageEl.className = 'chat-message own';
                messageEl.innerHTML = `<strong>„ÅÇ„Å™„Åü:</strong> ${message}`;
                chatMessages.appendChild(messageEl);
                chatMessages.scrollTop = chatMessages.scrollHeight;
                
                input.value = '';
                
                // Ëá™ÂãïËøî‰ø°„Çí„Ç∑„Éü„É•„É¨„Éº„Éà
                setTimeout(() => {
                    const replies = [
                        "„ÅÑ„ÅÑË≥™Âïè„Åß„Åô„Å≠ÔºÅ„Åù„ÅÆÊäÄË°ì„Å´„Å§„ÅÑ„Å¶Ë©≥„Åó„ÅèË™¨Êòé„Åó„Åæ„Åô„ÄÇ",
                        "ÁßÅ„ÇÇ„Åù„ÅÆ„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Å´ÂèÇÂä†„Åó„Å¶„ÅÑ„Åæ„ÅôÔºÅ",
                        "„Åù„ÅÆ„Éá„Éº„Çø„ÇíÊåÅ„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇÂÖ±Êúâ„Åó„Åæ„Åó„Çá„ÅÜ„ÅãÔºü",
                        "Á¥†Êô¥„Çâ„Åó„ÅÑ„Ç¢„Ç§„Éá„Ç¢„Åß„Åô„Å≠ÔºÅÂÆüÁèæÊñπÊ≥ï„ÇíËÄÉ„Åà„Åæ„Åó„Çá„ÅÜ„ÄÇ"
                    ];
                    const randomReply = replies[Math.floor(Math.random() * replies.length)];
                    
                    const botMessage = document.createElement('div');
                    botMessage.className = 'chat-message';
                    botMessage.innerHTML = `<strong>Global_Helper:</strong> ${randomReply}`;
                    chatMessages.appendChild(botMessage);
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }, 2000);
            }
        }

        // „Éó„É≠„Ç∏„Çß„ÇØ„ÉàÂèÇÂä†
        function joinProject(projectId) {
            const project = multiplayerState.coopProjects[projectId];
            project.participants++;
            showNotification(`ü§ù ${getProjectName(projectId)}„Å´ÂèÇÂä†„Åó„Åæ„Åó„ÅüÔºÅ`);
        }

        function donateToProject(projectId) {
            showNotification(`üí∞ ${getProjectName(projectId)}„Å´ECO„Éà„Éº„ÇØ„É≥„ÇíÂØÑ‰ªò„Åó„Åæ„Åó„ÅüÔºÅ`);
            // „Åì„Åì„ÅßÂÆüÈöõ„ÅÆÂØÑ‰ªòÂá¶ÁêÜ„ÇíÂÆüË£Ö
        }

        function getProjectName(projectId) {
            const names = {
                ocean_cleanup: 'Â§™Âπ≥Ê¥ã„Åî„Åø„Éô„É´„ÉàÊ∏ÖÊéÉ‰ΩúÊà¶',
                reforestation: '„Ç¢„Éû„Çæ„É≥ÂÜçÊ§çÊûó„Éó„É≠„Ç∏„Çß„ÇØ„Éà'
            };
            return names[projectId] || projectId;
        }

        // AI„Ç¢„Éâ„Éê„Ç§„Çπ
        function askAIAdvice() {
            const advice = [
                "Ê∞¥Ë≥áÊ∫ê„ÅÆÂäπÁéáÂåñ„Å´„ÅØ„ÄÅ„Ç∑„É≥„Ç¨„Éù„Éº„É´„ÅÆNEWaterÊäÄË°ì„Åå„Åä„Åô„Åô„ÇÅ„Åß„Åô",
                "„Ç®„Éç„É´„ÇÆ„ÉºÊ∂àË≤ª„ÇíÂâäÊ∏õ„Åô„Çã„Å´„ÅØ„ÄÅ„Éâ„Ç§„ÉÑ„ÅÆ„Çπ„Éû„Éº„Éà„Ç∞„É™„ÉÉ„Éâ„ÇíÂ∞éÂÖ•„Åó„Åæ„Åó„Çá„ÅÜ",
                "„Åî„ÅøÂá¶ÁêÜ„Å´„ÅØ„ÄÅÊó•Êú¨„ÅÆÈ´òÂ∫¶„Å™ÂàÜÂà•„Ç∑„Çπ„ÉÜ„É†„ÅåÂäπÊûúÁöÑ„Åß„Åô",
                "‰∫§ÈÄö„ÅÆCO2ÂâäÊ∏õ„Å´„ÅØ„ÄÅ„Éé„É´„Ç¶„Çß„Éº„ÅÆEVÊôÆÂèäÊîøÁ≠ñ„ÇíÂèÇËÄÉ„Å´„Åó„Å¶„Åè„Å†„Åï„ÅÑ"
            ];
            const randomAdvice = advice[Math.floor(Math.random() * advice.length)];
            
            showNotification(`ü§ñ AI„Ç¢„Éâ„Éê„Ç§„Çπ: ${randomAdvice}`);
        }

        // „Ç¢„Ç§„ÉÜ„É†Ë≥ºÂÖ•
        function buyItem(itemId) {
            const items = {
                japan_solar: { name: 'Êó•Êú¨„ÅÆÂ§™ÈôΩÂÖâÊäÄË°ì', price: { ECO: 1200 } },
                germany_wind: { name: '„Éâ„Ç§„ÉÑ„ÅÆÈ¢®Âäõ„Éá„Éº„Çø', price: { WTR: 850 } },
                singapore_water: { name: '„Ç∑„É≥„Ç¨„Éù„Éº„É´Ê∞¥Âá¶ÁêÜ', price: { NRG: 2100 } }
            };
            
            const item = items[itemId];
            if (item) {
                showNotification(`üõí ${item.name}„ÇíË≥ºÂÖ•„Åó„Åæ„Åó„ÅüÔºÅ`);
                // „Åì„Åì„ÅßÂÆüÈöõ„ÅÆË≥ºÂÖ•Âá¶ÁêÜ„ÇíÂÆüË£Ö
            }
        }

        // ÁîªÈù¢ÁÆ°ÁêÜ
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        // ÈÄöÁü•Ê©üËÉΩ
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 4000);
        }

        // „Éó„É¨„Ç§„É§„Éº„Éó„É≠„Éï„Ç£„Éº„É´Ë°®Á§∫
        function viewPlayerProfile(playerId) {
            const player = multiplayerState.onlinePlayers.find(p => p.id === playerId);
            if (player) {
                showNotification(`üë§ ${player.name}„ÅÆ„Éó„É≠„Éï„Ç£„Éº„É´: ${player.country} Lv.${player.level}`);
            }
        }

        // ÂçîÂäõ„É´„Éº„É†‰ΩúÊàê
        function createCoopRoom() {
            showNotification('üë• ÂçîÂäõ„É´„Éº„É†„Çí‰ΩúÊàê„Åó„Åæ„Åó„ÅüÔºÅ‰ªñ„ÅÆ„Éó„É¨„Ç§„É§„Éº„ÇíÊãõÂæÖ„Åß„Åç„Åæ„Åô');
        }

        // ÂàùÊúüÂåñÂÆüË°å
        window.onload = function() {
            initializeMultiplayerHub();
            showNotification('üåê „Ç∞„É≠„Éº„Éê„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„Å´Êé•Á∂ö„Åó„Åæ„Åó„Åü');
        };

        // „ÉÅ„É£„ÉÉ„ÉàÂÖ•Âäõ„ÅßEnter„Ç≠„ÉºÂØæÂøú
        document.getElementById('chatInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendChatMessage();
            }
        });
    </script>
</body>
</html>
