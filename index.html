<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SDGs World Builder</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }

        .app-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* 画面管理 */
        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        /* ヘッダー */
        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #00b894, #00cec9);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* カードスタイル */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .card:hover {
            transform: translateY(-5px);
            border-color: #00cec9;
            box-shadow: 0 10px 25px rgba(0, 206, 201, 0.3);
        }

        .card.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .card-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        /* 都市建設グリッド */
        .city-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin: 20px 0;
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 15px;
        }

        .grid-cell {
            aspect-ratio: 1;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .grid-cell:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .grid-cell.built {
            background: rgba(0, 184, 148, 0.3);
        }

        /* リソース表示 */
        .resources-bar {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .resource {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .resource-value {
            font-size: 1.5em;
            font-weight: bold;
            margin: 5px 0;
        }

        /* ボタンスタイル */
        .btn {
            background: linear-gradient(45deg, #00b894, #00cec9);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 184, 148, 0.4);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        /* ナビゲーション */
        .nav-tabs {
            display: flex;
            gap: 10px;
            margin: 20px 0;
        }

        .nav-tab {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .nav-tab.active {
            background: #00b894;
        }

        /* 通知 */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #00b894, #00a085);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            z-index: 1000;
            animation: slideIn 0.5s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* 進捗バー */
        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00b894, #00cec9);
            border-radius: 10px;
            transition: width 0.5s ease;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- スタート画面 -->
        <div id="startScreen" class="screen active">
            <div class="header">
                <h1>🌍 SDGs World Builder</h1>
                <p>世界の知恵を集めて、理想の未来都市を作ろう！</p>
            </div>
            <div style="text-align: center; margin-top: 50px;">
                <button class="btn" onclick="showScreen('countrySelect')">🚀 ゲームを始める</button>
                <button class="btn btn-secondary" onclick="showScreen('tutorial')">📚 遊び方</button>
            </div>
        </div>

        <!-- チュートリアル -->
        <div id="tutorial" class="screen">
            <div class="header">
                <h1>📚 遊び方</h1>
            </div>
            <div class="cards-grid">
                <div class="card">
                    <div class="card-icon">🌍</div>
                    <h3>1. 世界を探検</h3>
                    <p>各国を訪問してSDGsの成功事例を発見しよう</p>
                </div>
                <div class="card">
                    <div class="card-icon">🃏</div>
                    <h3>2. カードを収集</h3>
                    <p>発見した技術や政策をカードとして集めよう</p>
                </div>
                <div class="card">
                    <div class="card-icon">🏙️</div>
                    <h3>3. 都市を建設</h3>
                    <p>集めたカードを使って理想の都市を作ろう</p>
                </div>
                <div class="card">
                    <div class="card-icon">⚖️</div>
                    <h3>4. バランスを取る</h3>
                    <p>環境・経済・社会のバランスを考えよう</p>
                </div>
            </div>
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn" onclick="showScreen('startScreen')">← 戻る</button>
                <button class="btn" onclick="showScreen('countrySelect')">ゲームを始める →</button>
            </div>
        </div>

        <!-- 国選択画面 -->
        <div id="countrySelect" class="screen">
            <div class="header">
                <h1>🌏 訪問する国を選ぼう</h1>
                <p>各国で独自のSDGs解決策を発見できます</p>
            </div>
            
            <div class="nav-tabs">
                <div class="nav-tab active" onclick="showContinent('asia')">🌏 アジア</div>
                <div class="nav-tab" onclick="showContinent('europe')">🏰 ヨーロッパ</div>
                <div class="nav-tab" onclick="showContinent('africa')">🦁 アフリカ</div>
                <div class="nav-tab" onclick="showContinent('americas')">🌎 アメリカ</div>
            </div>

            <div class="cards-grid">
                <!-- アジア -->
                <div class="card continent-asia" onclick="selectCountry('japan')">
                    <div class="card-icon">🇯🇵</div>
                    <h3>日本</h3>
                    <p>ごみ分別・災害対策</p>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 30%"></div>
                    </div>
                    <small>発見率: 30%</small>
                </div>
                <div class="card continent-asia" onclick="selectCountry('singapore')">
                    <div class="card-icon">🇸🇬</div>
                    <h3>シンガポール</h3>
                    <p>水資源管理・都市計画</p>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0%"></div>
                    </div>
                    <small>未訪問</small>
                </div>

                <!-- ヨーロッパ -->
                <div class="card continent-europe" style="display: none" onclick="selectCountry('germany')">
                    <div class="card-icon">🇩🇪</div>
                    <h3>ドイツ</h3>
                    <p>エネルギー転換・リサイクル</p>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0%"></div>
                    </div>
                    <small>未訪問</small>
                </div>
                <div class="card continent-europe" style="display: none" onclick="selectCountry('norway')">
                    <div class="card-icon">🇳🇴</div>
                    <h3>ノルウェー</h3>
                    <p>電気自動車・再生エネルギー</p>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0%"></div>
                    </div>
                    <small>未訪問</small>
                </div>

                <!-- アフリカ -->
                <div class="card continent-africa" style="display: none" onclick="selectCountry('rwanda')">
                    <div class="card-icon">🇷🇼</div>
                    <h3>ルワンダ</h3>
                    <p>プラスチック禁止・清潔政策</p>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0%"></div>
                    </div>
                    <small>未訪問</small>
                </div>
            </div>

            <div style="text-align: center; margin-top: 30px;">
                <button class="btn btn-secondary" onclick="showScreen('startScreen')">← 戻る</button>
                <button class="btn" onclick="showScreen('cityBuilder')">🏙️ 都市を見る</button>
            </div>
        </div>

        <!-- 都市建設画面 -->
        <div id="cityBuilder" class="screen">
            <div class="header">
                <h1>🏙️ マイシティ建設</h1>
                <p>収集した技術で都市を発展させよう</p>
            </div>

            <!-- リソース表示 -->
            <div class="resources-bar">
                <div class="resource">
                    <div>💰</div>
                    <div class="resource-value" id="money">1,000,000</div>
                    <div>予算</div>
                </div>
                <div class="resource">
                    <div>🌿</div>
                    <div class="resource-value" id="environment">50%</div>
                    <div>環境指標</div>
                </div>
                <div class="resource">
                    <div>😊</div>
                    <div class="resource-value" id="happiness">65%</div>
                    <div>市民幸福度</div>
                </div>
                <div class="resource">
                    <div>⚡</div>
                    <div class="resource-value" id="energy">75%</div>
                    <div>エネルギー</div>
                </div>
            </div>

            <div class="nav-tabs">
                <div class="nav-tab active" onclick="showBuildTab('buildings')">🏗️ 施設建設</div>
                <div class="nav-tab" onclick="showBuildTab('technologies')">🔬 技術導入</div>
                <div class="nav-tab" onclick="showBuildTab('policies')">📜 政策実施</div>
            </div>

            <!-- 建設グリッド -->
            <div id="buildingsTab">
                <h3>施設を建設</h3>
                <div class="city-grid" id="cityGrid">
                    <!-- グリッドはJavaScriptで生成 -->
                </div>
                
                <div class="cards-grid">
                    <div class="card" onclick="buildFacility('solar')">
                        <div class="card-icon">☀️</div>
                        <h3>太陽光発電所</h3>
                        <p>エネルギー+20% 環境+15%</p>
                        <p>💰 コスト: 200,000</p>
                    </div>
                    <div class="card" onclick="buildFacility('recycling')">
                        <div class="card-icon">♻️</div>
                        <h3>リサイクル施設</h3>
                        <p>環境+25% 雇用+50人</p>
                        <p>💰 コスト: 150,000</p>
                    </div>
                    <div class="card" onclick="buildFacility('park')">
                        <div class="card-icon">🌳</div>
                        <h3>都市公園</h3>
                        <p>幸福度+15% 環境+10%</p>
                        <p>💰 コスト: 100,000</p>
                    </div>
                </div>
            </div>

            <!-- 技術タブ -->
            <div id="technologiesTab" style="display: none;">
                <h3>技術を導入</h3>
                <div class="cards-grid">
                    <div class="card disabled">
                        <div class="card-icon">🇯🇵</div>
                        <h3>日本のごみ分別</h3>
                        <p>リサイクル率+30%</p>
                        <p>🔓 日本を訪問すると解放</p>
                    </div>
                    <div class="card disabled">
                        <div class="card-icon">🇩🇪</div>
                        <h3>ドイツのエネルギー</h3>
                        <p>エネルギー効率+40%</p>
                        <p>🔓 ドイツを訪問すると解放</p>
                    </div>
                </div>
            </div>

            <div style="text-align: center; margin-top: 30px;">
                <button class="btn btn-secondary" onclick="showScreen('countrySelect')">🌍 国を探検</button>
                <button class="btn" onclick="nextTurn()">⏭️ 次のターン</button>
            </div>
        </div>
    </div>

    <script>
        // ゲーム状態
        const gameState = {
            currentScreen: 'startScreen',
            resources: {
                money: 1000000,
                environment: 50,
                happiness: 65,
                energy: 75
            },
            discoveredCountries: ['japan'],
            builtFacilities: [],
            currentTurn: 1
        };

        // 画面表示関数
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
            gameState.currentScreen = screenId;
        }

        // 大陸表示切り替え
        function showContinent(continent) {
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            document.querySelectorAll('.card').forEach(card => {
                card.style.display = 'none';
            });
            document.querySelectorAll('.continent-' + continent).forEach(card => {
                card.style.display = 'block';
            });
        }

        // 国選択
        function selectCountry(country) {
            if (!gameState.discoveredCountries.includes(country)) {
                gameState.discoveredCountries.push(country);
            }
            showNotification(`🇯🇵 ${getCountryName(country)}を訪問しました！`);
            exploreCountry(country);
        }

        function getCountryName(countryCode) {
            const names = {
                'japan': '日本',
                'singapore': 'シンガポール', 
                'germany': 'ドイツ',
                'norway': 'ノルウェー',
                'rwanda': 'ルワンダ'
            };
            return names[countryCode] || countryCode;
        }

        // 国探検
        function exploreCountry(country) {
            const discoveries = {
                'japan': '日本の高度なごみ分別技術を発見！',
                'singapore': 'シンガポールの水リサイクル技術を発見！',
                'germany': 'ドイツの再生可能エネルギー政策を発見！',
                'norway': 'ノルウェーの電気自動車普及策を発見！',
                'rwanda': 'ルワンダのプラスチック禁止政策を発見！'
            };
            
            showNotification(discoveries[country]);
            
            // 進捗バー更新
            const progressBar = document.querySelector(`.card[onclick="selectCountry('${country}')"] .progress-fill`);
            if (progressBar) {
                progressBar.style.width = '100%';
            }
        }

        // 建設タブ表示
        function showBuildTab(tab) {
            document.querySelectorAll('.nav-tab').forEach(navTab => {
                navTab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            document.getElementById('buildingsTab').style.display = 'none';
            document.getElementById('technologiesTab').style.display = 'none';
            document.getElementById(tab + 'Tab').style.display = 'block';
        }

        // 都市グリッド初期化
        function initializeCityGrid() {
            const grid = document.getElementById('cityGrid');
            grid.innerHTML = '';
            
            for (let i = 0; i < 25; i++) {
                const cell = document.createElement('div');
                cell.className = 'grid-cell';
                cell.innerHTML = '＋';
                cell.onclick = () => selectGridCell(i);
                grid.appendChild(cell);
            }
        }

        let selectedCell = null;

        function selectGridCell(index) {
            document.querySelectorAll('.grid-cell').forEach(cell => {
                cell.style.background = 'rgba(255, 255, 255, 0.1)';
            });
            
            const cell = document.querySelectorAll('.grid-cell')[index];
            cell.style.background = 'rgba(0, 206, 201, 0.3)';
            selectedCell = index;
        }

        // 施設建設
        function buildFacility(type) {
            if (selectedCell === null) {
                showNotification('❌ まず建設場所を選んでください');
                return;
            }

            const facilities = {
                'solar': { cost: 200000, environment: 15, energy: 20, name: '太陽光発電所' },
                'recycling': { cost: 150000, environment: 25, happiness: 5, name: 'リサイクル施設' },
                'park': { cost: 100000, environment: 10, happiness: 15, name: '都市公園' }
            };

            const facility = facilities[type];
            
            if (gameState.resources.money >= facility.cost) {
                gameState.resources.money -= facility.cost;
                gameState.resources.environment += facility.environment || 0;
                gameState.resources.happiness += facility.happiness || 0;
                gameState.resources.energy += facility.energy || 0;
                
                gameState.builtFacilities.push({
                    type: type,
                    cell: selectedCell,
                    name: facility.name
                });

                // グリッド更新
                const cell = document.querySelectorAll('.grid-cell')[selectedCell];
                cell.classList.add('built');
                cell.innerHTML = getFacilityIcon(type);
                
                updateResourceDisplay();
                showNotification(`✅ ${facility.name}を建設しました！`);
                
                selectedCell = null;
            } else {
                showNotification('❌ 予算が足りません');
            }
        }

        function getFacilityIcon(type) {
            const icons = {
                'solar': '☀️',
                'recycling': '♻️',
                'park': '🌳'
            };
            return icons[type] || '🏢';
        }

        // 次のターン
        function nextTurn() {
            gameState.currentTurn++;
            gameState.resources.money += 50000; // ターン収入
            
            // ランダムイベント
            const events = [
                { message: '🌧️ 大雨でエネルギー生産が増加', effect: { energy: 10 } },
                { message: '🎉 市民祭りで幸福度上昇', effect: { happiness: 5 } },
                { message: '📈 観光客が増加', effect: { money: 100000 } }
            ];
            
            const randomEvent = events[Math.floor(Math.random() * events.length)];
            showNotification(randomEvent.message);
            
            // 効果適用
            Object.keys(randomEvent.effect).forEach(resource => {
                gameState.resources[resource] += randomEvent.effect[resource];
            });
            
            updateResourceDisplay();
            showNotification(`⏰ ターン ${gameState.currentTurn} 開始`);
        }

        // リソース表示更新
        function updateResourceDisplay() {
            document.getElementById('money').textContent = gameState.resources.money.toLocaleString();
            document.getElementById('environment').textContent = Math.min(100, gameState.resources.environment) + '%';
            document.getElementById('happiness').textContent = Math.min(100, gameState.resources.happiness) + '%';
            document.getElementById('energy').textContent = Math.min(100, gameState.resources.energy) + '%';
        }

        // 通知表示
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // 初期化
        window.onload = function() {
            initializeCityGrid();
            updateResourceDisplay();
        };
    </script>
</body>
</html>
